<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is Pengyin Shan's Note">
<meta name="viewport" content="width=device-width">
<title>Pengyin's Note (old posts, page 1) | Pengyin's Note</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://pengyin-shan.com/index-1.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><style>
    div.input_prompt {
      display: none;
    }
    </style>
</head>
<body>
    <section class="social"><ul>
<li><a href="index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://www.linkedin.com/in/pengyinshan" title="My LinkedIn"><i class="icon-linkedin"></i></a></li>
            <li><a href="https://github.com/shanpy" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-9.html">Reading Notes for D3.js Part V (Chapter 9)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-9.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-9.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for <em>Interactive Data Visualization for the Web - An Introduction to Designing with D3</em> by <em>Scott Murray</em>, pulished by <em>O'Reilly, 2013</em></p>
<p>This post will contains concepts that I think it's important for me to be familiar with in D3 book.</p>
<h2>Chapter 9 : Animation</h2>
<p>code example for this chapter is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-V.html"><strong>here</strong></a>. This part involves lots of code practice.</p>
<h3>Transition and Animation</h3>
<p>When we <code>refresh</code> a d3 chart, we can use <code>transition</code> to add <code>animation</code> to this chart, so it looks better.</p>
<p><code>ordinal scale</code> can show the <code>discreate</code> domain, such as a set of names or categoires. These names or categories will be shown by a set of sequence, from left to right, equally.</p>
<p>You only need an <code>array</code> that contais name of categories to set of <code>range</code> of an <code>oridinal scale</code>. For example, <code>.domain([1,4,22,44)</code>.</p>
<p><code>d3.range()</code> can automatically generate continous array, normally we can use <code>d3.range(dataset.length)</code> for <code>x</code> position of each bar in chart.</p>
<p><code>range()</code> or <code>rangeBands()</code> can be used to do automatically <code>banding</code>. For example, <code>.rangeBands([0,w])</code> can automatically divide <code>0</code> to <code>w</code> to several parts. All parts have same width. <code>.rangeBands([0,w], 0.2)</code> means to set the <code>gap</code> between each part to be <code>20%</code> of each part's width.</p>
<p><code>rangeRoundBands()</code> is similar to <code>rangeBands()</code>. It will round the output to <code>integer</code>.</p>
<p><code>function(d,i){...}</code> can automatically get <code>i</code>, which is the <em>index</em> for <code>d</code> value. For example, <code>attr('x',function(d,i){ return xScale(i); }</code> will autotically set position for each <code>d</code> value.</p>
<p>Steps to update a d3 chart :</p>
<ul>
<li>
<p>Change value of dataset</p>
</li>
<li>
<p>Re-binding new value to existing elements</p>
</li>
<li>
<p>Re-set attribution so that new elements can be visible</p>
</li>
</ul>
<p>To add a <code>event listener</code>, you can do <code>d3.select('p').on('click',functon(){...})</code></p>
<p><code>.transition()</code> is used to add animation when you refresh your chart. This function needs to be inserted <em>before</em> changing of any attribute, and <em>after</em> select new elements. For example, <code>.data(dataset).transition().attr(...)</code>. D3 will automatically add transition value after you call this function.</p>
<p>Default duration for a <code>transition</code> is <code>1000</code>, which is 1000ms or 1s. <code>.duration()</code> can be used to set up duration. You must push this function <em>after</em> calling <code>.transition()</code>. For example, <code>.transition().duration(2000)</code> can change duration to 2s.</p>
<p>It is more proper to set small transition(such as <code>click</code>) to <code>150ms</code>. Long transition, such as refresh all chart, should be set to <code>1000ms</code>.</p>
<p>To change the animation of transiton, you can use <code>ease()</code>. Default value is <code>cubic-in-out</code>. It is proper to add this function <em>after</em> <code>transition()</code>. Other animations are:</p>
<ul>
<li>
<p><code>linear</code>: <code>ease('linear')</code></p>
</li>
<li>
<p><code>circle</code></p>
</li>
<li>
<p><code>elastic</code></p>
</li>
<li>
<p><code>bounce</code></p>
</li>
</ul>
<p><code>delay()</code> can be set to define when to start transition. You can pass a certain value, or a function to it, such as <code>.delay(function(d,i){ return i*1000;});</code>. This will make the animation of last element later than previous element, by 1s.</p>
<pre class="code literal-block"><span></span><span class="c1">//...</span>
<span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
<span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">i</span><span class="o">/</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">lenght</span><span class="o">*</span><span class="mi">1000</span><span class="p">;</span>
    <span class="c1">//This will make i ratioly to dataset, then times 1000. Total time not change, time for each element is different.</span>
<span class="p">})</span>
</pre>


<p><code>each()</code> can be used to add opeartion when transition start or end. each accepts two parameters:</p>
<ul>
<li>
<p><code>start</code> or <code>end</code>. You can use <code>this</code> to get current element.</p>
</li>
<li>
<p>a function that will run when start or end transition</p>
</li>
</ul>
<p>Element can only have <em>one</em> transition animation at any time. So you <em>can not</em> add more <code>transition()</code> in a <code>each('start',function(){...})</code>. But you <em>can</em> do this in <code>each('end',function(){...}</code>.</p>
<pre class="code literal-block"><span></span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s1">'end'</span><span class="p">,</span><span class="nx">fucntion</span><span class="p">(){</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="c1">//Select current single element</span>
        <span class="p">.</span><span class="nx">transition</span><span class="p">()</span> <span class="c1">//You can not add this in start function</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="nx">red</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">//you can also do .each(function(d,i){...})</span>
</pre>


<p>You can do continues transition in 3.0 version:</p>
<pre class="code literal-block"><span></span><span class="c1">//...</span>
<span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="nx">fuction</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">yScle</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'yellow'</span><span class="p">);</span>
</pre>


<h3>Clip-Path</h3>
<p><code>clipPath()</code> can create an <code>area</code>, so that only when element's part is <em>inside</em> this area, this part can be seen. Steps are:</p>
<ul>
<li>
<p>Define <code>clipPath</code> and give it an id.</p>
</li>
<li>
<p>Put a visible element in <code>clipPath</code>, such as <code>rect</code> or <code>circle</code></p>
</li>
<li>
<p>Add a reference to <code>clipPath</code> on the element that use <code>clipPath</code></p>
</li>
</ul>
<blockquote>
<pre class="code literal-block"><span></span><span class="c1">//Define clipPath</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'clipPath'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'chart-area'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span> <span class="c1">//Make this clipPath to a rectange</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="nx">padding</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="nx">padding</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="nx">w</span><span class="o">-</span><span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
</pre>


</blockquote>
<pre class="code literal-block"><span></span>//Create circle
svg.append('g') //create new g element and set id
    .attr('id','circles')
    .attr('clip-path','url(#chare-area)') //add reference to clipPath
    .selectAll('circle')
    .data(dataset)
    .enter()
    .append('circle')
    ...

//Now all circle elements has been wrapped in a group, this group has a reference to a rectange that has size of all svg.
//If any circle is out of this rectangle, the out part will be cut.
</pre>


<h3>Add or Remove Element</h3>
<p>To <em>add new</em> rectangle(or other elments), re-select and re-append <code>rects</code>, then after <code>enter()</code>, use <code>attr('x',w)</code> to make the new bar to right most right of svg, so no one can see it. The use <code>transition().attr('x',...).attr('y',...).attr('width',...).attr('height',...)</code> to make it in with animation. Now new element will be on <em>right</em> of old elements.</p>
<p>To <em>delete</em> existing element, using <code>exit()</code>. You can firstly remove <em>first</em> element from dataset by using <code>dataset.shift()</code>, then do:</p>
<pre class="code literal-block"><span></span><span class="nx">bars</span><span class="p">.</span><span class="nx">exit</span><span class="p">().</span><span class="nx">transition</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="nx">w</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">remove</span><span class="p">();</span> <span class="c1">//remove last element from DOM</span>

<span class="c1">//You should update tags if you have any</span>
</pre>


<h3>Key-Value Pair Dataset</h3>
<p>D3 has <code>index</code> with each value in dataset automatically. However, you may needs to define your own <code>key</code> when you need. You can define <code>key-value</code> pair in dataset if you need:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[{</span><span class="nx">key</span><span class="o">:</span><span class="s1">'apple'</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span>
                <span class="p">{</span><span class="nx">key</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">200</span><span class="p">}];</span>
<span class="c1">// {} define object</span>
<span class="c1">// [] define array</span>
</pre>


<p>Now you need to use <code>d3.value</code> to access value. You can set <code>var key = function(d){ return d.key;}</code> for future usage, the use <code>.data(dataset,key)</code> to assign dataset.</p>
<p>Now to let the <em>left most</em> bar remove from <em>left</em>, use <code>.exit().transition().attr('x',-xScale.rangeBand()</code>.</p>
<h3>Code Example For This Chapter</h3>
<p>You can check the interative version from <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-V.html"><strong>here</strong></a>.</p>
<pre class="code literal-block"><span></span><span class="c1">//Code Part I: Transition Animation</span>

<span class="c1">//set up random data set</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">maxValue</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">count</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span> <span class="nx">count</span><span class="o">++</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">maxValue</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">count</span><span class="o">*</span><span class="mi">10</span><span class="p">);;</span>
        <span class="kd">var</span> <span class="nx">pair</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="nx">dataset</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">pair</span><span class="p">);</span>
    <span class="p">}</span>

<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">key</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//set up svg</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter9'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="s1">'100%'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span>

<span class="c1">//set up ordinal scale</span>
<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">ordinal</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span>
            <span class="c1">//return an array that has same length as dataset. Here should be 0,1,...,9</span>
            <span class="p">.</span><span class="nx">rangeRoundBands</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">w</span><span class="p">],</span><span class="mf">0.05</span><span class="p">);</span>
            <span class="c1">//Banding: d3 will calculate from 0 to w, how many bands it can be divided. And we set the gap between each band is 5%. We use rangRoundBands to get integer value.</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;})])</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>

<span class="c1">//Create Ractangular</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">//using x scale, set up i, which is the corresonding index 0,1,...10 for d.</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span> <span class="c1">//y's position should be the same as before</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">())</span><span class="c1">//now d3 will automatically set up width of each bar, based on xScale</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span> <span class="c1">//height needs to following scale first, then using height minus</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="s1">'rgb(120,233,'</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">//Add Tag</span>
<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="p">});</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">+</span><span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span> <span class="s1">'pink'</span><span class="p">);</span>

<span class="c1">//set up axis</span>
<span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">'top'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">yAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">yScale</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">'right'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'axis xaxis'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate(0,'</span><span class="o">+</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">)</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'axis yaxis'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate('</span> <span class="o">+</span> <span class="nx">padding</span> <span class="o">+</span> <span class="s1">',0)'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>


<span class="c1">//Add Trigger Event for Button</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'btn'</span><span class="p">)).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//Note: we now have new dataset</span>
    <span class="kd">var</span> <span class="nx">dataset2</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">maxValue</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">count</span><span class="o">&lt;</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">count</span><span class="o">++</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">maxValue</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">count</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">pair</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="nx">dataset2</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">pair</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//update yScale to make sure y axis will change. If you change size of new dataset, you need to update x scale also!</span>
    <span class="nx">yScale</span><span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset2</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">})]);</span>

    <span class="c1">//update rectange</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset2</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">transition</span><span class="p">()</span> <span class="c1">//add transition animation</span>
        <span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">i</span><span class="o">/</span><span class="nx">dataset2</span><span class="p">.</span><span class="nx">length</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span>  <span class="c1">//delay time: make each bar's animation later than previous one, proporationaly. So last one will delay 1000ms, last two will delay less than 1000ms, etc</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">//add duration of anitmation: 1000 ms</span>
        <span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s1">'start'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'stroke'</span><span class="p">,</span><span class="s1">'black'</span><span class="p">);</span> <span class="c1">//for each item, do this at the start of animation. Note you can not add another transition() here. If so current transition will be interrupt</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="s1">'rgb(120,100,'</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">;</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'grey'</span><span class="p">);</span> <span class="c1">//Since previous transition has done, You can add another transition() here.This one will not interrupt privous transition</span>


    <span class="c1">//update tag</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset2</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">transition</span><span class="p">()</span> <span class="c1">//add transition animation</span>
        <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">2500</span><span class="p">)</span> <span class="c1">//add duration of anitmation: 5000 ms</span>
            <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">+</span><span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span> <span class="c1">//in y axis. if you add a position number, it will go down.</span>
            <span class="p">});</span>

    <span class="c1">//Update Axis</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">".xaxis"</span><span class="p">).</span><span class="nx">transition</span><span class="p">().</span><span class="nx">duration</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'.yaxis'</span><span class="p">).</span><span class="nx">transition</span><span class="p">().</span><span class="nx">duration</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>

<span class="p">});</span>

    <span class="c1">//Code Part II: Add Or Remove Element</span>

    <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'add'</span><span class="p">)).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>

    <span class="cm">/*add a new element to dataset</span>
<span class="cm">    var maxValue = 50;</span>
<span class="cm">    var newNumber = Math.round(Math.random() * maxValue);</span>
<span class="cm">    dataset.push(newNumber);</span>
<span class="cm">    */</span>

    <span class="kd">var</span> <span class="nx">maxValue</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">minValue</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">pair</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">minValue</span><span class="p">);</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">maxValue</span><span class="p">);</span>
        <span class="nx">dataset</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">pair</span><span class="p">);</span>

    <span class="c1">//Update xScale since dataset change its length and max may need to change</span>
    <span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">ordinal</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span>
            <span class="p">.</span><span class="nx">rangeRoundBands</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">w</span><span class="p">],</span><span class="mf">0.05</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;})])</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>

    <span class="c1">//re-select all rectangulars and create new bar element</span>
    <span class="kd">var</span> <span class="nx">bars</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>
    <span class="nx">bars</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span> <span class="c1">//get new elements. Note: add transition() here will cause error</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span> <span class="c1">//use append() to create this new element</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span> <span class="c1">//re-define width</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="s1">'rgb(50,150,'</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">;</span>
        <span class="p">});</span>

    <span class="c1">//Update attributes of new bar element</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span>
        <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">});</span>

   <span class="c1">//re-update tags</span>
   <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span><span class="nx">key</span><span class="p">).</span><span class="nx">transition</span><span class="p">();</span> <span class="c1">//note we don't need enter() and append() here because there is no new element</span>
   <span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
   <span class="p">});</span>
   <span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
   <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span>
   <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'black'</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">//Remove a Bar from right</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'remove'</span><span class="p">)).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">dataset</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span><span class="c1">//remove the first element from dataset.</span>

    <span class="kd">var</span> <span class="nx">bars</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span><span class="nx">key</span><span class="p">);</span> <span class="c1">//note you add key here to make sure key is self-defined, instead of default index</span>
    <span class="nx">bars</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span> <span class="c1">//Returns the exit selection: existing DOM elements in the current selection for which no new data element was found</span>
        <span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="o">-</span><span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">())</span> <span class="c1">//remove from left</span>
        <span class="p">.</span><span class="nx">remove</span><span class="p">();</span> <span class="c1">//remove the elements in the current selection fromt the current document</span>

    <span class="c1">//update tags</span>
    <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span><span class="nx">key</span><span class="p">);</span>
              <span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
               <span class="p">});</span>
               <span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="c1">//after remove, i still start from 0. However the key now start from second element</span>
               <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span>
               <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'orange'</span><span class="p">);</span>
<span class="p">});</span>
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-8.html">Reading Notes for D3.js Part IV (Chapter 8)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-8.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-8.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for <em>Interactive Data Visualization for the Web - An Introduction to Designing with D3</em> by <em>Scott Murray</em>, pulished by <em>O'Reilly, 2013</em></p>
<p>This post will contains concepts that I think it's important for me to be familiar with in D3 book.</p>
<h2>Chapter 8 : Axes</h2>
<p>code example for this chapter is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-IV.html"><strong>here</strong></a>. This part involves lots of code practice.</p>
<p>The axes in D3 are functions with parameters. Differnt from scale, axes function will not return anything. Instead, it will geneate elements such as axes line, axes tags, etc.</p>
<p>Note: <em>Axes function only apply to SVG</em></p>
<p>Using <code>d3.svg.axis(scale)</code> to set up axis with certain scale.</p>
<p>Using <code>axis.orient('bottom/top/left/right')</code> to set up location of tags in axis.</p>
<p>Using <code>svg.append('g').call(axis)</code> to append axis to svg. <code>g</code> means a <em>group</em> element. This <em>group</em> element includes <code>path</code>,<code>line</code> and <code>text</code> elements for axis.</p>
<p>You can give style to axis, using <em>css</em>. By using <code>.attr('class','class_name')</code>, you can assign class to <code>g</code> group, then set style in style sheet using <code>.class_name line{}</code> or <code>.class_name text()</code>. <code>path</code> and <code>line</code> can share same rule in stylesheet.</p>
<p><em>Note: you should use svg attributes in style sheet, instead of css attributes</em></p>
<p><code>shape-rendering</code> style make sure the number of tags in axis is as clear as pixels.</p>
<p>You can move axis to bottom/left/right using <code>transform</code> attribute and <code>translate()</code> function. For example:</p>
<pre class="code literal-block"><span></span><span class="c1">//...</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate(0,10)'</span><span class="p">)</span>
    <span class="c1">//move axis down in 10. Note positive y means going down</span>

    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate(10,0)'</span><span class="p">)</span>
    <span class="c1">//move axis right in 10. This usually apply to y-axis.</span>
</pre>


<p><code>.ticks(number)</code> is to set how many axis tags you want. This is just a suggestion, D3 will <em>automatically</em> adjust to it.</p>
<p><code>d3.format()</code> can set up a format. For example, <code>d3.format('.1%'')</code> means make a number to keep one decimal point, then add '%' after it. Then you can use <code>axis.tickFormat(d3.format('.1%''))</code> to make this apply to axis tags, if you want.</p>
<p><em>Code Example for this Chapter</em> <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-IV.html">You can check result of code here</a></p>
<pre class="code literal-block"><span></span><span class="c">&lt;!--style after adding axis--&gt;</span>
<span class="p">&lt;</span><span class="nt">style</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/css"</span><span class="p">&gt;</span>
        <span class="nc">.axis</span> <span class="nt">path</span><span class="o">,</span>
        <span class="nc">.axis</span> <span class="nt">line</span> <span class="p">{</span>
          <span class="n">fill</span><span class="o">:</span> <span class="nb">none</span><span class="p">;</span>
          <span class="n">stroke</span><span class="o">:</span> <span class="nb">green</span><span class="p">;</span>
          <span class="n">shape</span><span class="o">-</span><span class="n">rendering</span><span class="o">:</span> <span class="n">crispEdges</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nc">.axis</span> <span class="nt">text</span><span class="p">{</span>
            <span class="nb">font-size</span><span class="o">:</span> <span class="m">10px</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>


    <span class="c1">//set up SVG</span>
    <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

    <span class="c1">//set up random data set</span>
    <span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numOfPoint</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="c1">//we want 10 point</span>
    <span class="kd">var</span> <span class="nx">xRange</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">yRange</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">count</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">count</span><span class="o">&lt;</span><span class="nx">numOfPoint</span><span class="p">;</span> <span class="nx">count</span><span class="o">++</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">newx</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">xRange</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">newy</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">yRange</span><span class="p">);</span>
        <span class="nx">dataset</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">newx</span><span class="p">,</span><span class="nx">newy</span><span class="p">]);</span> <span class="c1">//Add array to empty array</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter8'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span> <span class="s1">'100%'</span><span class="p">)</span> <span class="c1">//This can make svg take full width of div</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="s1">'400'</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span> <span class="c1">//get width of svg, assign it to w variable</span>

    <span class="c1">//set up scatter plot</span>
    <span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span> <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="p">})</span> <span class="o">+</span> <span class="nx">padding</span><span class="p">])</span> <span class="c1">//add extra padding to make sure leftest circle not be cut through middle</span>
                    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">w</span><span class="o">-</span><span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">]);</span>
    <span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="p">})</span><span class="o">+</span><span class="nx">padding</span><span class="p">])</span>
                    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
    <span class="kd">var</span> <span class="nx">rScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span> <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="p">})])</span>
                    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">]);</span>

    <span class="nx">circle</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">rScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'pink'</span><span class="p">);</span>

    <span class="c1">//set up tag for scatter plot</span>
    <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">});</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">});</span>

    <span class="c1">//Add line betwen these points</span>
    <span class="kd">var</span> <span class="nx">lineFunction</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">line</span><span class="p">()</span>
                        <span class="p">.</span><span class="nx">x</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="p">})</span>
                        <span class="p">.</span><span class="nx">y</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="p">})</span>
                        <span class="p">.</span><span class="nx">interpolate</span><span class="p">(</span><span class="s2">"linear"</span><span class="p">);</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">lineFunction</span><span class="p">(</span><span class="nx">dataset</span><span class="p">))</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'stroke'</span><span class="p">,</span><span class="s1">'blue'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'stroke-width'</span><span class="p">,</span><span class="s1">'1'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'none'</span><span class="p">);</span>

    <span class="c1">//set up axis</span>
    <span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span> <span class="c1">//use scale</span>
                    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">'bottom'</span><span class="p">)</span> <span class="c1">//make axis at bottom</span>
                    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="c1">//make only 5 tags for axis</span>
    <span class="kd">var</span> <span class="nx">yAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">yScale</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">'right'</span><span class="p">)</span> <span class="c1">//make axis on left</span>
                    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span><span class="c1">//make only 7 tags for axis</span>

    <span class="c1">//Append axis to svg</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'axis'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate(0,'</span><span class="o">+</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span> <span class="c1">//make x axis move down, with the distance of h-padding*2</span>
        <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span> <span class="c1">//add axis</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'axis'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate('</span> <span class="o">+</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="s1">',0)'</span><span class="p">)</span> <span class="c1">//make y axis move right, with the distance of padding</span>
        <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>

<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-7.html">Reading Notes for D3.js Part III (Chapter 7)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-7.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-7.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for <em>Interactive Data Visualization for the Web - An Introduction to Designing with D3</em> by <em>Scott Murray</em>, pulished by <em>O'Reilly, 2013</em></p>
<p>This post will contains concepts that I think it's important for me to be familiar with in D3 book.</p>
<h2>Chapter 7 : Scale (Linear)</h2>
<p>code example for this chapter is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-III.html"><strong>here</strong></a>. This part involves lots of code practice.</p>
<p>In D3, the scales are the functions that has parameters. You pass value to these functions, then they pass out values based on scale.</p>
<p><code>input domain</code> means possible range for input values</p>
<p><code>output range</code> means possible range for output values, mostly by pixels.</p>
<p><code>normalization</code> means based on possible min and max value, transfer a value to a new value <em>between 0 and 1</em>. This is what we are doing for linear scale.</p>
<h3>Create Scale</h3>
<h4>Code Part I</h4>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">scale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">();</span> <span class="c1">//Now scale is a function for linear scale</span>

<span class="nx">scale</span><span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">]);</span> <span class="c1">//set up input domain</span>

<span class="nx">scale</span><span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">350</span><span class="p">]);</span> <span class="c1">//set up output range</span>

<span class="c1">//now scale(100) will return 10, scale(300) will return 180</span>
</pre>


<h3>Zoomed Scatter Plot</h3>
<h4>Code Part II</h4>
<p>We can make the input range more flexiable by using <code>d3.min()</code> and <code>d3.max()</code>. Normall we can just do <code>d3.min(dataset)</code>. To get max value from an array of arrays:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">],[</span><span class="mi">20</span><span class="p">,</span><span class="mi">200</span><span class="p">],[</span><span class="mi">74</span><span class="p">,</span><span class="mi">40</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">300</span><span class="p">]</span>
                <span class="p">];</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="c1">//This will compare x value for single array. d[1] will compare y value</span>
<span class="p">})</span>

<span class="c1">//Full Code to create Zoomed Scatter Plot</span>
<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">250</span><span class="p">;</span>
<span class="c1">//Add padding to make sure circle will not be cut to half</span>
<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">],[</span><span class="mi">20</span><span class="p">,</span><span class="mi">120</span><span class="p">],[</span><span class="mi">74</span><span class="p">,</span><span class="mi">35</span><span class="p">],[</span><span class="mi">85</span><span class="p">,</span><span class="mi">85</span><span class="p">],[</span><span class="mi">60</span><span class="p">,</span><span class="mi">99</span><span class="p">]</span>
            <span class="p">];</span>

<span class="c1">//X Axis: Make input domain be max in dataset, based on x value. Output range is the width of SVG</span>
<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span> <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">];})])</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="nx">w</span><span class="o">-</span><span class="nx">padding</span><span class="p">]);</span>

<span class="c1">//Y Axis: Make input range be max in dataset, based on y value. Output range is the height of SVG</span>
<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span> <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];})])</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span>  <span class="c1">//Note normally larger y is at bottom. We change to make larger y on top</span>

<span class="c1">//Radius: Make a self defined scale so that the radius is between 2 and 5, but still show scales</span>
<span class="kd">var</span> <span class="nx">rScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span> <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];})])</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span>


<span class="c1">//Create SVG and Add Border to it</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"chapter7"</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'2'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="nx">w</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>

<span class="c1">//create a scatter plot</span>
<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">);</span>

<span class="c1">//Set cx, cy to new value based on scale</span>
<span class="nx">circle</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">});</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
    <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">});</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">rScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">});</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'green'</span><span class="p">);</span>

<span class="c1">//Set tag based on scale</span>
<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="p">});</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">});</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">});</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'pink'</span><span class="p">);</span>

<span class="c1">//Now if svg change, the position of circles will adjust automatically</span>
</pre>


<h3>Other Methods and Scales</h3>
<p><code>scale.nice()</code>: Extend the domain so it starts and ends on nice round values. Following formula: <code>exp(round(log(dx))-1)</code>. For example, <code>[0.998, 2.5555]</code> to <code>[1,2.5]</code></p>
<p><code>scale.rangeRound()</code>: Round ranges to closest <code>intenger</code></p>
<p><code>scale.clamp()</code>: Force all values that <em>out of range</em> to be in closest range, i.e, max or min value.</p>
<p><code>scale.sqrt</code>: square root scale</p>
<p><code>scale.pow</code>:  power scales, following <code>y = mx^k + b</code></p>
<p><code>scale.log</code>: log scales, following <code>y = mlog(x) + b</code></p>
<p><code>scale.quanitize</code>: a variant of linear scales with a discrate rather than continuous range. for example <code>quantize(0.49)</code> returns 0 and <code>quantize(0.51)</code> returns 1</p>
<p><code>scale.quantile</code>: map an input domain to a discreate range. Input domain is <code>discreate</code> value</p>
<p><code>scale.ordinal</code>: input domain is un-qualified value. For example, <code>apple</code> or <code>monkey</code></p>
<p><code>d3.time.scale</code>: scale for date and time</p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-6.html">Reading Notes for D3.js Part II (Chapter 6)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-6.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-6.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for <em>Interactive Data Visualization for the Web - An Introduction to Designing with D3</em> by <em>Scott Murray</em>, pulished by <em>O'Reilly, 2013</em></p>
<p>This post will contains concepts that I think it's important for me to be familiar with in D3 book.</p>
<h2>Chapter 6 : Draw Graph basiced on Data</h2>
<p>code example for this chapter is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-II.html"><em>here</em></a>. This part involves lots of code practice.</p>
<p>Everything is <code>rectangular</code> for browser. Using <code>div</code> is the easiest way to draw a <em>Bar Chart</em>.</p>
<h4>code part I</h4>
<p><code>attr()</code> set up the value for a DOM attribute, such as <code>.attr('class','bar')</code></p>
<p><code>style()</code> add css style to an element</p>
<p><code>classed()</code> quickly add/delete class to an element, such as <code>.classed('bar',true/false)</code> to add/delete a class <code>bar</code> to an element</p>
<p><code>select().selectAll().data().enter()</code> put data to <code>data</code>, then use/create elements using <code>selectAll()</code>, append them in <code>select()</code>, for example:</p>
<pre class="code literal-block"><span></span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"test"</span><span class="p">))</span> <span class="c1">//select the space that is a div "test"</span>
    <span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'div'</span><span class="p">)</span> <span class="c1">//create divs in 'test' div</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">).</span><span class="nx">enter</span><span class="p">();</span> <span class="c1">//for each new div, put data to it</span>
</pre>


<h3>Draw SVG</h3>
<h4>code part II</h4>
<p>For each <code>SVG</code> element, all its properties are defined by <code>property='XXX'</code>, such as <code>&lt;element property = 'value'&gt;&lt;/element&gt;</code></p>
<p>First step is always create a <code>SVG</code> element:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span> <span class="c1">//This is pixel</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter6'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s2">"2"</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="nx">w</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>
<span class="c1">//Create size of svg</span>
</pre>


<p>Then draw a circle:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">circles</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">);</span> <span class="c1">//create circle and put data in</span>

<span class="nx">circles</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="p">;</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">d</span><span class="p">;</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'yellow'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'stroke'</span><span class="p">,</span><span class="s1">'pink'</span><span class="p">);</span>
            <span class="c1">//Add center point and radius. Then add color to it</span>
</pre>


<h3>Draw Bar Chart</h3>
<h4>code part III</h4>
<p>In D3, always choose element that you need, even before it is created.</p>
<p><code>SVG</code> only support alignment through <em>left-upper</em> corner. To make sure bar chart using bottom alignment:</p>
<ul>
<li>
<p>make the <code>y</code>, which is the vertical point of alignment point, equals to <code>total height - its own height</code></p>
</li>
<li>
<p>then make each bar has height equal to its data.</p>
</li>
</ul>
<p>Make color be ratio to data:</p>
<pre class="code literal-block"><span></span><span class="c1">//add color to rectangular. Make each bar has color ratio to its data</span>
<span class="nx">rect</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span><span class="p">(</span><span class="s2">"rgb(0,0,"</span><span class="o">+</span><span class="p">(</span><span class="nx">d</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="s2">")"</span><span class="p">);</span>
<span class="p">});</span>
</pre>


<p>The way to add <code>tags</code> is the same to add <code>rect</code>:</p>
<pre class="code literal-block"><span></span><span class="c1">//create text</span>
<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>

<span class="c1">//set text position. Adjust position a little bit</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">i</span><span class="o">*</span><span class="p">(</span><span class="nx">w</span><span class="o">/</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">;</span>
                <span class="p">})</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="p">(</span><span class="nx">d</span><span class="o">+</span><span class="mi">5</span><span class="p">);</span>
                <span class="p">});</span>

<span class="c1">//add text value</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">d</span><span class="p">;</span> <span class="c1">//Get integer value in JavaScript</span>
                <span class="p">});</span>

<span class="c1">//set font family</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'font-family'</span><span class="p">,</span><span class="s1">'sans-serif'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'font-size'</span><span class="p">,</span><span class="s1">'1em'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'blue'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'text-anchor'</span><span class="p">,</span><span class="s1">'middle'</span><span class="p">);</span> <span class="c1">//set text alignment</span>
</pre>


<h3>Draw Scatter Plot</h3>
<h4>code part IV</h4>
<p>For a scatter plot, data should look like an array of arrays:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
                                <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                                <span class="p">[</span><span class="mf">15.30</span><span class="p">],</span>
                                <span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">],</span>
                                <span class="p">[</span><span class="mi">99</span><span class="p">,</span><span class="mi">35</span><span class="p">]</span>
            <span class="p">];</span>
<span class="c1">//First Numer is X axis, Second Numer is y axis</span>
</pre>


<p>The way to draw a scatter plot is generating lots of circles on <code>svg</code>, each circle is a point:</p>
<pre class="code literal-block"><span></span><span class="c1">//prepare data</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">115</span><span class="p">,</span><span class="mi">130</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">160</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">199</span><span class="p">,</span><span class="mi">135</span><span class="p">]</span>
                <span class="p">];</span>

<span class="c1">//create svg element</span>
<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span> <span class="c1">//This is pixel</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter6'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s2">"4"</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="nx">w</span><span class="p">)</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>

<span class="c1">//create circles</span>
<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
<span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
<span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">);</span>

<span class="c1">//set up cx, cy, r</span>
<span class="nx">circle</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span> <span class="c1">//Here, d is the single array in array group</span>
                    <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="c1">//note it should be first element in array</span>
                <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">//y should be second element in array</span>
                <span class="p">});</span>

<span class="c1">//Make area of circle be proportional to data, using A = π*r^2. We just assume y is the area here</span>
<span class="nx">circle</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">3.14</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
                <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'pink'</span><span class="p">);</span>

<span class="c1">//Add Tags</span>
<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">});</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="p">});</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">});</span>
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-12.html">Reading Notes for D3.js Part VIII (Chapter 12)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-12.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-12.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for <em>Interactive Data Visualization for the Web - An Introduction to Designing with D3</em> by <em>Scott Murray</em>, pulished by <em>O'Reilly, 2013</em></p>
<p>This post will contains concepts that I think it's important for me to be familiar with in D3 book.</p>
<h2>Chapter 12 : Map</h2>
<p>code example for Chapter 12 is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-VIII.html"><strong>here</strong></a>.</p>
<p><code>GeoJSON</code> is a special format for <code>JSON</code>, which is used specially for geography. A typical <code>GeoJSON</code> file is an object with two attributes: <code>type</code> and <code>features</code>. The <code>features</code> attibute is an array of objects. Each objects have geography attributes, such as <code>type</code>,<code>id</code>,<code>properties</code>,<code>geometry</code>.</p>
<p _="%" images_posts_samplegeojson.png="images/posts/sampleGeoJSON.png" img><code>geometry</code> is a vary useful attributes. It can include <code>coordinate</code> attribue, which inludes <code>longitude,latitude</code> pairs. Note <code>longitude</code> is <em>vertical</em> on map, <code>latitude</code> is <em>horizontal</em> on map. Here is a sample:</p>
<p>Step 1: transfer <code>GeoJSON</code> to <code>SVG path</code> code by using <code>d3.geo.path()</code>. Then load <code>GeoJSON</code> file and apply new path:</p>
<pre class="code literal-block"><span></span><span class="c1">//set a path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">();</span>

<span class="c1">//load map json file. Since this is a callback function, code outside will run the same time as inside</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'/js/us-states.json'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">){</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">path</span><span class="p">);</span> <span class="c1">//This line will create a path generator to get all geography data and generate svg path</span>
<span class="p">});</span>
</pre>


<p>Step 2: create <code>projection</code> to transfer <em>3D</em> to <em>2D</em>, then use <code>d3.geo.path().projection()</code> to apply projection to path. You can also add <code>scale()</code> to make map smaller or larger:</p>
<pre class="code literal-block"><span></span><span class="c1">//Apply scale and Use projection to let map cover all states in US, using a build-in projector albersUsa()</span>
<span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">albersUsa</span><span class="p">()</span>
                        <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span><span class="c1">//Make projection to the center of svg</span>
                        <span class="p">.</span><span class="nx">scale</span><span class="p">([</span><span class="mi">500</span><span class="p">])</span><span class="c1">//make map smaller. Default value is 1000.</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">().</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span> <span class="c1">//Apply new projection to current path;</span>
</pre>


<h3>Use Color to Quantize Map</h3>
<p>We can add color with different combination to map to show data difference in map. For example, the place that has more populatio with dark blue and less population with light green, etc.</p>
<p>Step1: create a <em>quantize</em> scale with <em>color</em> as output. A combination of color can be found in https://github.com/mbostock/d3/tree/master/lib/colorbrewer, from D3 library. Now we output <em>discreate</em> value as color. The number of colors decides how precise the map will be. Less color group will make map has less color combination:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">quantize</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="s1">'['</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">237</span><span class="p">,</span><span class="mi">248</span><span class="p">,</span><span class="mi">251</span><span class="p">)</span><span class="s1">','</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">204</span><span class="p">,</span><span class="mi">236</span><span class="p">,</span><span class="mi">230</span><span class="p">)</span><span class="s1">','</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">153</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">201</span><span class="p">)</span><span class="s1">','</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span><span class="mi">194</span><span class="p">,</span><span class="mi">164</span><span class="p">)</span><span class="s1">','</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">44</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">95</span><span class="p">)</span><span class="s1">','</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">44</span><span class="p">)</span><span class="s1">']'</span><span class="p">);</span>
    <span class="c1">//Here we want to devide data to different bucket.</span>
</pre>


<p>Step2: use <code>d3.json()</code> or <code>d3.csv()</code> to load data. In data callback function, set up color input domain:</p>
<pre class="code literal-block"><span></span><span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'sample.json'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span> <span class="c1">//note we use var data to represent data in json file</span>
    <span class="nx">color</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span>
    <span class="p">[</span><span class="nx">d3</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">}),</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;})]</span>
    <span class="p">);</span>
    <span class="c1">//Here we get min and max value from data</span>
<span class="p">});</span>
</pre>


<p>Step3: load data. We may need to combine data in two json/csv file. To do this, <em>wrap</em> another data callback function in current data callback function, then compare column with same data. if it fits, add an attribute in a dataset with the nessiary data from the other dataset. You can use <em>nested for loop</em> to compare data:</p>
<pre class="code literal-block"><span></span><span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'1.json'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data1</span><span class="p">){</span>

    <span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s1">'2.csv'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data2</span><span class="p">){</span> <span class="c1">//load another csv file</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">data1</span><span class="p">.</span><span class="nx">attr1</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span> <span class="c1">//First for loop for data in json</span>
        <span class="kd">var</span> <span class="nx">combine1</span> <span class="o">=</span> <span class="nx">data1</span><span class="p">.</span><span class="nx">attr1</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="o">/</span><span class="nx">value</span><span class="o">/</span><span class="p">...;</span>

        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">data2</span><span class="p">.</span><span class="nx">attr2</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">){</span> <span class="c1">//Second for loop for data in csv</span>
            <span class="kd">var</span> <span class="nx">combine2</span> <span class="o">=</span> <span class="nx">data2</span><span class="p">.</span><span class="nx">attr2</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="o">/</span><span class="nx">value</span><span class="o">/</span><span class="p">...;</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">combine1</span> <span class="o">==</span> <span class="nx">combine2</span><span class="p">){</span> <span class="c1">//Check if combine 1 and combine 2 has the same data that can be joined</span>
                <span class="nx">combine2</span><span class="p">.</span><span class="nx">attr2</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">newValue</span> <span class="o">=</span> <span class="nx">data1</span><span class="p">.</span><span class="nx">attr1</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
                <span class="c1">//Get the data we need from data1 and put it as a new attribute for data2</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="c1">//After find a proper fit, jump out of current for loop and check another value from data1</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="p">})</span>
<span class="p">})</span>
</pre>


<p>Step 4: create path and load data to path. You need to do this <em>inside</em> a callback loop since we need to use data variable in loop. We need to check if the value in second json/csv exist or not in first json/csv. If not, we need return a single color:</p>
<pre class="code literal-block"><span></span><span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data1</span><span class="p">.</span><span class="nx">attr1</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="s1">'path'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">attr1</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span> <span class="c1">//value that you want to apply color</span>

        <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="c1">//check exist</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">color</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="s2">"grey"</span><span class="p">;</span>
            <span class="c1">//if no value, make this part of map as grey.</span>
        <span class="p">}</span>
    <span class="p">})</span>
</pre>


<p>Step 5: create and add projection. Note you need to do this step <em>outside</em> of callback function so that your result will not be affected.</p>
<h3>Add Circle as Data Point on Map</h3>
<p>If we have json/csv file that have city names, value, and cities longitude, latitude data, we can make it on map.</p>
<p>Step1, Step2, Step3, Step4: Same as example above.</p>
<p>Step 5: load new data and add circle to map. You need create projection function <em>before</em> this step, buy don't apply it to all map. Also, you need to put this part <em>inside</em> callback function, so that your circle will not be covered by map since map will be loaded later than outside functions:</p>
<pre class="code literal-block"><span></span><span class="nx">svg</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s1">'3.csv'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data3</span><span class="p">){</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data3</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">projector</span><span class="p">([</span><span class="nx">d</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">lat</span><span class="p">])[</span><span class="mi">0</span><span class="p">];</span>
        <span class="c1">//Apply your projector function to the array combined by lon and lat, then get first element as new lon</span>

        <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">projector</span><span class="p">([</span><span class="nx">d</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">lat</span><span class="p">])[</span><span class="mi">1</span><span class="p">];</span>
        <span class="c1">//Apply your projector function to the array combined by lon and lat, then get first element as new lat</span>

        <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="nx">functon</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">attrName</span><span class="p">)</span><span class="o">*</span><span class="mf">0.00004</span><span class="p">);</span>
            <span class="c1">//Get the value of the attribute value you want to use, then apply Math.sqrt to get r from coverage size.</span>
        <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'yellow'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'opacity'</span><span class="p">,</span><span class="mf">0.75</span><span class="p">);</span>
        <span class="c1">//You can set up opacity if you want</span>
<span class="p">})</span>
</pre>


<h3>Code For This Chapter</h3>
<p>code example for Chapter 12 is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-VIII.html"><strong>here</strong></a>.</p>
<pre class="code literal-block"><span></span><span class="c1">//Part I Code</span>
<span class="kd">function</span> <span class="nx">part1</span><span class="p">(){</span>
<span class="c1">//create svg</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter12'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="s1">'100%'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span>

<span class="c1">//set a path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">();</span>

<span class="c1">//load map json file. Since this is a callback function, code outside will run the same time as inside</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'/data/us-states.json'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">){</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">path</span><span class="p">);</span> <span class="c1">//This line will create a path generator to get all geography data and generate svg path</span>
<span class="p">});</span>

<span class="c1">//Apply scale and Use projection to let map cover all states in US, using a build-in projector albersUsa()</span>
<span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">albersUsa</span><span class="p">()</span>
                        <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span><span class="c1">//Make projection to the center of svg</span>
                        <span class="p">.</span><span class="nx">scale</span><span class="p">([</span><span class="mi">500</span><span class="p">])</span><span class="c1">//make map smaller. Default value is 1000.</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">().</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span> <span class="c1">//Apply new projection to current path;</span>
<span class="p">}</span>


<span class="c1">//Part II Code</span>
<span class="kd">function</span> <span class="nx">part2</span><span class="p">(){</span>
<span class="c1">//Create svg</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter12'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'2'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="s1">'100%'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span>


<span class="c1">//Create a scale with different color for quantize map. Here we devide color to 6 groups. You can set your own.</span>
<span class="c1">//Color reference: https://github.com/mbostock/d3/tree/master/lib/colorbrewer</span>
<span class="kd">var</span> <span class="nx">colorBrew</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'rgb(237,248,251)'</span><span class="p">,</span><span class="s1">'rgb(204,236,230)'</span><span class="p">,</span><span class="s1">'rgb(153,216,201)'</span><span class="p">,</span><span class="s1">'rgb(102,194,164)'</span><span class="p">,</span><span class="s1">'rgb(44,162,95)'</span><span class="p">,</span><span class="s1">'rgb(0,109,44)'</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">quantize</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">colorBrew</span><span class="p">);</span> <span class="c1">//We need to wait till data finish loading to add input domain</span>


<span class="c1">//Set up path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">();</span>


<span class="c1">//Load data</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s1">'/data/us-ag-productivity-2004.csv'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="nx">color</span><span class="p">.</span><span class="nx">domain</span><span class="p">([</span>
            <span class="c1">//set up input domain after data has been loaded</span>
            <span class="nx">d3</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;}),</span>
            <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;})</span>
        <span class="p">]);</span>

    <span class="c1">//Add csv data to json because we can only bind one group of data to elements.</span>
    <span class="c1">//Note you need to do this in d3.csv() because this step rely on csv data</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'/data/us-states.json'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">){</span>

        <span class="c1">//Mix data in csv file</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">dataState</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">state</span><span class="p">;</span> <span class="c1">//get state name in csv file</span>
            <span class="kd">var</span> <span class="nx">dataValue</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span> <span class="c1">//get value in csv file. Note the column of csv file is state and value</span>

            <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">jsonState</span> <span class="o">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">properties</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span> <span class="c1">//Find state name in json file</span>

                <span class="k">if</span><span class="p">(</span><span class="nx">jsonState</span> <span class="o">==</span> <span class="nx">dataState</span><span class="p">){</span>
                    <span class="c1">//copy csv value to json file, make a key as value</span>
                    <span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">dataValue</span><span class="p">;</span>
                    <span class="c1">//go out for loop. we don't need to check more state in json file.</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//Now create path and apply data</span>
        <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span> <span class="c1">//check if value exist or not</span>
                    <span class="k">return</span> <span class="nx">color</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="k">return</span> <span class="s2">"grey"</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">});</span>
<span class="p">});</span>

<span class="c1">//Add Projector</span>
<span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">albersUsa</span><span class="p">()</span>
                        <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span><span class="c1">//Make projection to the center of svg</span>
                        <span class="p">.</span><span class="nx">scale</span><span class="p">([</span><span class="mi">500</span><span class="p">])</span><span class="c1">//make map smaller. Default value is 1000.</span>
<span class="nx">path</span><span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>
<span class="p">}</span>


<span class="c1">//Part III Code</span>
<span class="kd">function</span> <span class="nx">part3</span><span class="p">(){</span>
    <span class="c1">//create svg</span>
    <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter12'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'3'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="s1">'100%'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span>

    <span class="c1">//create projector</span>
    <span class="kd">var</span> <span class="nx">proj</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">albersUsa</span><span class="p">().</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">]).</span><span class="nx">scale</span><span class="p">([</span><span class="mi">500</span><span class="p">]);</span>

    <span class="c1">//create path generator</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">();</span>

    <span class="c1">//create color brew</span>
    <span class="kd">var</span> <span class="nx">colorBrew</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#ffffd4"</span><span class="p">,</span><span class="s2">"#fed98e"</span><span class="p">,</span><span class="s2">"#fe9929"</span><span class="p">,</span><span class="s2">"#d95f0e"</span><span class="p">,</span><span class="s2">"#993404"</span><span class="p">];</span> <span class="c1">//This time use 5 groups. Color effect will be different from example 2</span>
    <span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">quantize</span><span class="p">().</span><span class="nx">range</span><span class="p">(</span><span class="nx">colorBrew</span><span class="p">);</span>

    <span class="c1">//load population change.csv file</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s1">'/data/us-ag-productivity-2004.csv'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>

            <span class="c1">//set color input domain</span>
            <span class="nx">color</span><span class="p">.</span><span class="nx">domain</span><span class="p">(</span>
                <span class="p">[</span><span class="nx">d3</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;}),</span>
                 <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;})]</span>
                <span class="p">);</span>

            <span class="c1">//Combine data in csv to data in json</span>
            <span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'/data/us-states.json'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data2</span><span class="p">){</span>
                <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
                    <span class="kd">var</span> <span class="nx">dataState</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">state</span><span class="p">;</span>
                    <span class="kd">var</span> <span class="nx">dataValue</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span>

                    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">data2</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">){</span>
                    <span class="kd">var</span> <span class="nx">data2State</span> <span class="o">=</span> <span class="nx">data2</span><span class="p">.</span><span class="nx">features</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">properties</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="nx">dataState</span> <span class="o">==</span> <span class="nx">data2State</span><span class="p">){</span>
                        <span class="nx">data2</span><span class="p">.</span><span class="nx">features</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">dataValue</span><span class="p">;</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>



                <span class="c1">//Draw map and add color,projector</span>
            <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'path'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">data2</span><span class="p">.</span><span class="nx">features</span><span class="p">).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">path</span><span class="p">).</span><span class="nx">style</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span> <span class="c1">//note since we use data2.features as dataset, here d is equal to data2.features single item</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">color</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="k">return</span> <span class="s2">"black"</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>

            <span class="c1">//load csv data from us cities.csv. Make sure you do this in data callback function so that circle is on top of map. Otherwise circle will be covered by map</span>
            <span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s1">'/data/us cities.csv'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data3</span><span class="p">){</span>
                <span class="c1">//create circle that represetns city, then apply projector to it</span>
                <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">data3</span><span class="p">).</span><span class="nx">enter</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                    <span class="c1">//ImportantL proj(lon,lat) will return a array of two</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">proj</span><span class="p">([</span><span class="nx">d</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">lat</span><span class="p">])[</span><span class="mi">0</span><span class="p">];</span> <span class="c1">//0 postion is longitude</span>
                    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">proj</span><span class="p">([</span><span class="nx">d</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">lat</span><span class="p">])[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">//1 position is latitude.</span>
                    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">population</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.00004</span><span class="p">);</span> <span class="c1">//use sqrt to get r from coverage of population</span>
                    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'green'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'opacity'</span><span class="p">,</span><span class="mf">0.75</span><span class="p">);</span>
            <span class="p">});</span>
            <span class="p">});</span>
    <span class="p">});</span>

            <span class="c1">//apply projector</span>
            <span class="nx">path</span><span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">proj</span><span class="p">);</span>
            <span class="c1">//Important! When you use projection for full map(i.e, all paths), you must do this out side data callback function!</span>


    <span class="p">}</span>
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-11.html">Reading Notes for D3.js Part VII (Chapter 11)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-11.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-11.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for <em>Interactive Data Visualization for the Web - An Introduction to Designing with D3</em> by <em>Scott Murray</em>, pulished by <em>O'Reilly, 2013</em></p>
<p>This post will contains concepts that I think it's important for me to be familiar with in D3 book.</p>
<h2>Chapter 11 : Layout</h2>
<p>code example for Chapter 11 is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-VII.html"><strong>here</strong></a>.</p>
<p>All Layouts for D3 are:</p>
<ul>
<li>
<p><code>Bundle</code>: assign <code>Holten</code> algorithem to <code>edge</code></p>
</li>
<li>
<p><code>Chord</code>: generate <code>chord diagram</code></p>
</li>
<li>
<p><code>Cluster</code>: generate <code>dendrogram</code></p>
</li>
<li>
<p><code>Force</code>: generate and assign <code>nodes</code> following physics</p>
</li>
<li>
<p><code>Hierarchy</code>: there are sevel layer in chart. Each chart inherience layout from previous layer</p>
</li>
<li>
<p><code>Histogram</code>: generate <code>histogram</code></p>
</li>
<li>
<p><code>Pack</code>: generate layout based on <code>circle packing</code></p>
</li>
<li>
<p><code>Partition</code>: generate adjacency diagrams: a space-filling variant of a node-link tree diagram</p>
</li>
<li>
<p><code>Pie</code>: generate pie chart</p>
</li>
<li>
<p><code>Stack</code>: generate base line for a series of bars</p>
</li>
<li>
<p><code>Tree</code>: generate tree chart</p>
</li>
<li>
<p><code>Treemap</code>: generate a group of rectangles. Each reactangles size is based on radio of data.</p>
</li>
</ul>
<h3>Pie Chart</h3>
<p>Step one: given a dataset(array of numbers), you can use <code>var pie = d3.layout.pie()</code> to convert this dataset to a <em>new</em> dataset with numbers ready for pie chart.</p>
<p>Step two: you can use <code>d3.svg.arc()</code> to create <code>arc</code> for pie chart. This function will generate a <code>path</code> variable, which can draw any shape in SVG:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">outRadius</span> <span class="o">=</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="c1">//If h is smaller, make outter radius to h/2 so center will be at the center of height</span>
<span class="kd">var</span> <span class="nx">inRadius</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">arc</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">arc</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">innerRadius</span><span class="p">(</span><span class="nx">inRadius</span><span class="p">)</span>
                <span class="c1">//set the inner radius of arc to 0 so that they can all center a point. You can also set to other value if you need</span>
                <span class="p">.</span><span class="nx">outerRadius</span><span class="p">(</span><span class="nx">outRadius</span><span class="p">);</span>
</pre>


<p>Step 3: create new group and make arcs in this group to comine a pie chart. Then add <code>path</code> element to store arcs data and generate shape:</p>
<pre class="code literal-block"><span></span><span class="c1">//After code above</span>

<span class="kd">var</span> <span class="nx">arcs</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'g.arc'</span><span class="p">)</span> <span class="c1">//This is the way to wrap elements to group when creating elements!</span>
            <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">pie</span><span class="p">(</span><span class="nx">dataset</span><span class="p">))</span> <span class="c1">//Or you can use d3.layout.pie(dataset) to convert original dataset</span>
            <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">)</span> <span class="c1">//you only append g here</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'arc'</span><span class="p">)</span> <span class="c1">//create class for easier usage</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate('</span><span class="o">+</span><span class="nx">outRadius</span><span class="o">+</span><span class="s1">', '</span><span class="o">+</span><span class="nx">outRadius</span><span class="o">+</span><span class="s1">')'</span><span class="p">);</span>
            <span class="c1">//This step move arcs to certain position for pie chart</span>


<span class="c1">//A color function to call default ten d3 colors</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">category10</span><span class="p">();</span>


<span class="c1">//Now add path to generate shape</span>
<span class="nx">arcs</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">color</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">//d3 will automatically find d and i based on dataset</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="nx">arc</span><span class="p">);</span> <span class="c1">//Assign arc created by arc() function</span>

<span class="c1">//Add Tags for this pie chart</span>
    <span class="nx">arcs</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="s2">"translate("</span> <span class="o">+</span> <span class="nx">arc</span><span class="p">.</span><span class="nx">centroid</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">;</span>  <span class="c1">//centroid is the center point of any shape. Here means move tag to center of shape</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'text-anchor'</span><span class="p">,</span><span class="s1">'middle'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span> <span class="c1">//Use d.value here because new dataset make d as key-value pair</span>
    <span class="p">});</span>
</pre>


<h3>Stack Layout</h3>
<p>Step 1: Assume you have a dataset which contains objects with attributes, you need to <em>re-organize</em> this dataset to objects with <code>x-y</code> attribues. <code>x</code> is the <code>ID</code> value. <code>y</code> is the actally value of original data:</p>
<pre class="code literal-block"><span></span><span class="c1">//Sample Dataset</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nx">apple</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span> <span class="nx">banana</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">peach</span><span class="o">:</span> <span class="mi">150</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">apple</span><span class="o">:</span><span class="mi">177</span><span class="p">,</span> <span class="nx">banana</span><span class="o">:</span> <span class="mi">98</span><span class="p">,</span> <span class="nx">peach</span><span class="o">:</span> <span class="mi">35</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">apple</span><span class="o">:</span> <span class="mi">59</span><span class="p">,</span> <span class="nx">banana</span><span class="o">:</span> <span class="mi">87</span><span class="p">,</span> <span class="nx">peach</span><span class="o">:</span> <span class="mi">120</span><span class="p">}</span>
<span class="p">];</span>

<span class="c1">//Re-origanize dataset. Each key group become a array. x means index, y is the value</span>
<span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">25</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">177</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">59</span><span class="p">}],</span> <span class="c1">//apple group</span>
    <span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">50</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">98</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">87</span><span class="p">}],</span> <span class="c1">//banana group</span>
    <span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">150</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">35</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">120</span><span class="p">}]</span> <span class="c1">//peach group</span>
<span class="p">];</span>
</pre>


<p _="%" chart data.png images_posts_stack="images/posts/stack" img>Step 2: similar to pie chart, use <code>d3.layout.stack(dataset)</code> to re-generate dataset. Note this will generate a <code>y0</code> value as <em>baseline</em> for each object, which equals to the <em>total</em> of all <code>y</code> value for its previous object / the minimum y-position of the value:</p>
<p>Step 3: Assign <code>x</code>,<code>y</code>,<code>width</code>,<code>height</code> attribute to each rect. You need to use <code>d.y0</code> and <code>d.y</code> for <code>y</code> and <code>height</code>:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">rects</span> <span class="o">=</span> <span class="nx">groups</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y0</span><span class="p">;</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">())</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">color</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y0</span><span class="p">);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'stroke'</span><span class="p">,</span><span class="s1">'black'</span><span class="p">);</span>

<span class="c1">//This will create a bar chart with three columns, which are the three objects in original dataset</span>

<span class="c1">//Each column will have three ractangle, representing three attributes for each object in original dataset</span>
</pre>


<h3>Force Directed Layout</h3>
<p>This layout is <em>dragable</em> by user, and the chart will move following physic role. This layout use <code>graph</code>, which is combined by <code>node</code> and <code>edge</code>.</p>
<p>Step 1: This layout needs special dataset which defining <code>nodes</code> and <code>edges</code> object. <code>nodes</code> has <code>name</code> attribute. <code>edges</code> has <code>source</code> and <code>target</code> and <code>weight</code> attributes, which defines the <em>from</em> and <em>to</em> attribute for each edge, with <em>line weight</em>:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">nodes</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'apple'</span><span class="p">},</span> <span class="c1">//name of nodes</span>
        <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'peach'</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'banana'</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'pear'</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'pineapple'</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="nx">edges</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nx">source</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span> <span class="nx">target</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">weight</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span> <span class="c1">//edges linking nodes.Has a source and a target</span>
        <span class="p">{</span><span class="nx">source</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">target</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="nx">weight</span><span class="o">:</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">source</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="nx">target</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span> <span class="nx">weight</span><span class="o">:</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">source</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span> <span class="nx">target</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span> <span class="nx">weight</span><span class="o">:</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">source</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span> <span class="nx">target</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="nx">weight</span><span class="o">:</span><span class="mi">5</span><span class="p">}</span>
        <span class="c1">//Important: make sure last source connect back to existing source!</span>
    <span class="p">]</span>
<span class="p">};</span>
</pre>


<p>Step 2: Using <code>d3.layout.force()</code> to initailize dataset. You need to set <code>.nodes()</code> and <code>.links()</code> with data in dataset, then set <code>size</code> of how far user can drag. Use <code>start()</code> to finish initialization:</p>
<pre class="code literal-block"><span></span><span class="c1">//Initialize force-directed graph</span>
<span class="kd">var</span> <span class="nx">force</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">layout</span><span class="p">.</span><span class="nx">force</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">nodes</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">nodes</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">links</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">edges</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">size</span><span class="p">([</span><span class="nx">w</span><span class="p">,</span><span class="nx">h</span><span class="p">])</span>
                    <span class="p">.</span><span class="nx">linkDistance</span><span class="p">([</span><span class="mi">50</span><span class="p">])</span> <span class="c1">//distance between each node</span>
                    <span class="p">.</span><span class="nx">charge</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">])</span> <span class="c1">//how much nodes wanting to escape from each other</span>
                    <span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</pre>


<p>Step 3: Set attributes for <code>nodes</code> and <code>ages</code>. At the ends of <code>nodes</code> attribute, make sure use <code>.call(force.drage)</code> to enable the ability of dragging.</p>
<pre class="code literal-block"><span></span><span class="c1">//Create line to connecting nodes</span>
<span class="kd">var</span> <span class="nx">edges</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'line'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">edges</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'line'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'stroke'</span><span class="p">,</span><span class="s1">'black'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'stroke-width'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">weight</span><span class="p">;</span>
                <span class="p">});</span>

<span class="c1">//Create circle as nodes</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">category10</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">nodes</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">color</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
                <span class="p">})</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">force</span><span class="p">.</span><span class="nx">drag</span><span class="p">);</span>      <span class="c1">//start the function to drag circles.</span>
</pre>


<p>Step 4: Define what is going to happen in <code>tick</code>, which means define the behavior of chart when a time frame pass by. Here we want for each time frame, chart will update nodes and edges:</p>
<pre class="code literal-block"><span></span><span class="c1">//Define tick: what is going to happen for each time second</span>
<span class="nx">force</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'tick'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">edges</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x1'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span> <span class="c1">//x1 of edge to be x of source</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y1'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">y</span> <span class="c1">//y1 of edge to be y of source</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x2'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y2'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="nx">nodes</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="p">})</span>
<span class="p">})</span>
</pre>


<h3>Code for This Chapter</h3>
<p>An interacive version is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-VII.html"><strong>here</strong></a>.</p>
<pre class="code literal-block"><span></span>//Part I Code

//create random dataset
var numberOfData = 10;
var dataset = [];
for(var i=1; i<span class="p">&lt;</span><span class="nt">numberOfData</span><span class="err">;</span> <span class="na">i</span><span class="err">++){</span>
    <span class="na">dataset</span><span class="err">.</span><span class="na">push</span><span class="err">(</span><span class="na">Math</span><span class="err">.</span><span class="na">round</span><span class="err">(</span><span class="na">Math</span><span class="err">.</span><span class="na">random</span><span class="err">()*</span><span class="na">i</span><span class="err">*</span><span class="na">30</span><span class="err">));</span>
<span class="err">}</span>


<span class="err">//</span><span class="na">create</span> <span class="na">svg</span>
<span class="na">var</span> <span class="na">h</span><span class="o">=</span> <span class="s">300;</span>
<span class="na">var</span> <span class="na">padding </span><span class="o">=</span> <span class="s">5;</span>
<span class="na">var</span> <span class="na">svg </span><span class="o">=</span> <span class="s">d3.select(document.getElementById('chapter11').getElementsByClassName('1')[0]).append('svg').attr('height',h).attr('width','100%');</span>
<span class="na">var</span> <span class="na">w </span><span class="o">=</span> <span class="s">document.getElementsByTagName('svg')[0].offsetWidth;</span>

<span class="err">//</span><span class="na">Get</span> <span class="na">pie</span> <span class="na">value</span> <span class="na">data</span> <span class="na">from</span> <span class="na">d3</span><span class="err">.</span><span class="na">layout</span><span class="err">.</span><span class="na">pie</span> <span class="na">function</span>
<span class="na">var</span> <span class="na">pie </span><span class="o">=</span> <span class="s">d3.layout.pie();</span>
<span class="na">dataset </span><span class="o">=</span> <span class="s">pie(dataset);</span>

<span class="err">//</span><span class="na">create</span> <span class="na">pie</span> <span class="na">chart</span> <span class="na">based</span> <span class="na">on</span> <span class="na">new</span> <span class="na">dataset</span><span class="err">.</span> <span class="na">Use</span> <span class="na">d3</span><span class="err">.</span><span class="na">svg</span><span class="err">.</span><span class="na">arc</span><span class="err">()</span> <span class="na">and</span> <span class="na">path</span> <span class="na">to</span> <span class="na">create</span> <span class="na">arc</span>
<span class="na">var</span> <span class="na">outRadius </span><span class="o">=</span> <span class="s">h/2;</span>
<span class="na">var</span> <span class="na">inRadius </span><span class="o">=</span> <span class="s">0;</span>
<span class="na">var</span> <span class="na">arc </span><span class="o">=</span> <span class="s">d3.svg.arc().innerRadius(inRadius).outerRadius(outRadius);</span> <span class="err">//</span><span class="na">assign</span> <span class="na">two</span> <span class="na">radius</span> <span class="na">to</span> <span class="na">arc</span>

<span class="err">//</span><span class="na">Put</span> <span class="na">arcs</span> <span class="na">to</span> <span class="na">group</span><span class="err">,</span> <span class="na">and</span> <span class="na">binding</span> <span class="na">data</span>
<span class="na">var</span> <span class="na">arcs </span><span class="o">=</span> <span class="s">svg.selectAll('g.arc')</span> <span class="err">//</span><span class="na">This</span> <span class="na">is</span> <span class="na">how</span> <span class="na">to</span> <span class="na">add</span> <span class="na">class</span> <span class="na">elements</span> <span class="na">to</span> <span class="na">a</span> <span class="na">group</span>
                <span class="err">.</span><span class="na">data</span><span class="err">(</span><span class="na">dataset</span><span class="err">)</span>
                <span class="err">.</span><span class="na">enter</span><span class="err">()</span>
                <span class="err">.</span><span class="na">append</span><span class="err">('</span><span class="na">g</span><span class="err">')</span>
                <span class="err">.</span><span class="na">attr</span><span class="err">('</span><span class="na">class</span><span class="err">','</span><span class="na">arc</span><span class="err">')</span>
                <span class="err">.</span><span class="na">attr</span><span class="err">('</span><span class="na">transform</span><span class="err">','</span><span class="na">translate</span><span class="err">('</span> <span class="err">+</span> <span class="na">outRadius</span> <span class="err">+</span> <span class="err">',</span> <span class="err">'</span> <span class="err">+</span> <span class="na">outRadius</span> <span class="err">+</span> <span class="err">')');</span>
                <span class="err">//</span><span class="na">transform</span> <span class="na">to</span> <span class="na">right</span> <span class="na">with</span> <span class="na">outRadius</span> <span class="na">value</span><span class="err">,</span> <span class="na">transform</span> <span class="na">to</span> <span class="na">button</span> <span class="na">with</span> <span class="na">outRadius</span> <span class="na">value</span>

<span class="err">//</span><span class="na">Add</span> <span class="na">path</span> <span class="na">element</span> <span class="na">and</span> <span class="na">put</span> <span class="na">arc</span> <span class="na">to</span> <span class="na">it</span>
<span class="na">arcs</span><span class="err">.</span><span class="na">append</span><span class="err">('</span><span class="na">path</span><span class="err">')</span>
    <span class="err">.</span><span class="na">attr</span><span class="err">('</span><span class="na">fill</span><span class="err">',</span><span class="na">function</span> <span class="err">(</span><span class="na">d</span><span class="err">)</span> <span class="err">{</span>
        <span class="na">return</span> <span class="err">'</span><span class="na">rgb</span><span class="err">(</span><span class="na">100</span><span class="err">,'</span> <span class="err">+</span> <span class="na">Math</span><span class="err">.</span><span class="na">round</span><span class="err">(</span><span class="na">d</span><span class="err">.</span><span class="na">value</span><span class="err">)</span> <span class="err">+</span> <span class="err">",</span><span class="na">200</span><span class="err">)";</span> <span class="err">//</span><span class="na">You</span> <span class="na">need</span> <span class="na">to</span> <span class="na">use</span> <span class="na">d</span><span class="err">.</span><span class="na">value</span> <span class="na">here</span> <span class="na">because</span> <span class="na">data</span> <span class="na">source</span> <span class="na">now</span> <span class="na">is</span> <span class="na">pie</span><span class="err">.</span>
    <span class="err">}).</span><span class="na">attr</span><span class="err">('</span><span class="na">d</span><span class="err">',</span><span class="na">arc</span><span class="err">);</span>

<span class="err">//</span><span class="na">Add</span> <span class="na">Tags</span> <span class="na">for</span> <span class="na">this</span> <span class="na">pie</span> <span class="na">chart</span>
<span class="na">arcs</span><span class="err">.</span><span class="na">append</span><span class="err">('</span><span class="na">text</span><span class="err">').</span><span class="na">attr</span><span class="err">('</span><span class="na">transform</span><span class="err">',</span><span class="na">function</span><span class="err">(</span><span class="na">d</span><span class="err">){</span>
    <span class="na">return</span> <span class="err">"</span><span class="na">translate</span><span class="err">("</span> <span class="err">+</span> <span class="na">arc</span><span class="err">.</span><span class="na">centroid</span><span class="err">(</span><span class="na">d</span><span class="err">)</span> <span class="err">+</span> <span class="err">')';</span>  <span class="err">//</span><span class="na">centroid</span> <span class="na">is</span> <span class="na">the</span> <span class="na">center</span> <span class="na">point</span> <span class="na">of</span> <span class="na">any</span> <span class="na">shape</span><span class="err">.</span> <span class="na">Here</span> <span class="na">means</span> <span class="na">move</span> <span class="na">tag</span> <span class="na">to</span> <span class="na">center</span> <span class="na">of</span> <span class="na">shape</span>
<span class="err">}).</span><span class="na">attr</span><span class="err">('</span><span class="na">text-anchor</span><span class="err">','</span><span class="na">middle</span><span class="err">')</span>
<span class="err">.</span><span class="na">text</span><span class="err">(</span><span class="na">function</span><span class="err">(</span><span class="na">d</span><span class="err">){</span>
    <span class="na">return</span> <span class="na">d</span><span class="err">.</span><span class="na">value</span><span class="err">;</span>
<span class="err">});</span>

<span class="err">&lt;/</span><span class="na">script</span><span class="p">&gt;</span>

<span class="c">&lt;!--Part II Code--&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>
<span class="c1">//Sample Dataset</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nx">apple</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span> <span class="nx">banana</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">peach</span><span class="o">:</span> <span class="mi">150</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">apple</span><span class="o">:</span><span class="mi">177</span><span class="p">,</span> <span class="nx">banana</span><span class="o">:</span> <span class="mi">98</span><span class="p">,</span> <span class="nx">peach</span><span class="o">:</span> <span class="mi">35</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">apple</span><span class="o">:</span> <span class="mi">59</span><span class="p">,</span> <span class="nx">banana</span><span class="o">:</span> <span class="mi">87</span><span class="p">,</span> <span class="nx">peach</span><span class="o">:</span> <span class="mi">120</span><span class="p">}</span>
<span class="p">];</span>

<span class="c1">//Re-origanize dataset. Each key group become a array. x means index, y is the value</span>
<span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">25</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">177</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">59</span><span class="p">}],</span> <span class="c1">//apple group</span>
    <span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">50</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">98</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">87</span><span class="p">}],</span> <span class="c1">//banana group</span>
    <span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">150</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">35</span><span class="p">},</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">120</span><span class="p">}]</span> <span class="c1">//peach group</span>
<span class="p">];</span>

<span class="c1">//Use d3.layout.stack() to modify dataset</span>
<span class="kd">var</span> <span class="nx">stack</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">layout</span><span class="p">.</span><span class="nx">stack</span><span class="p">();</span>
<span class="nx">stack</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="c1">//create svg</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter11'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'2'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="s1">'100%'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span>

<span class="c1">//create scale</span>
<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">ordinal</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span>
            <span class="p">.</span><span class="nx">rangeRoundBands</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">w</span><span class="p">],</span><span class="mf">0.05</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y0</span><span class="p">;</span>
                    <span class="p">});</span>
                <span class="p">})])</span>
                <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>

<span class="c1">//Add a group for each row of data</span>
<span class="kd">var</span> <span class="nx">groups</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'g'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'group'</span><span class="p">);</span>

<span class="c1">//Add bar chart</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">category10</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">rects</span> <span class="o">=</span> <span class="nx">groups</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"x: "</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" y: "</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="s2">" y0: "</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y0</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">.</span><span class="nx">y0</span><span class="p">;</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">())</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">color</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">);</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'stroke'</span><span class="p">,</span><span class="s1">'black'</span><span class="p">);</span>

<span class="c1">//add tags</span>
<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">groups</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
<span class="p">});</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">.</span><span class="nx">y0</span><span class="o">-</span><span class="nx">padding</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">);;</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c">&lt;!--Part III Code--&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>
//data should be a group, contains a nodes array group and an edges arraygroup
var dataset = {
    nodes: [
        {name: 'apple'}, //name of nodes
        {name: 'peach'},
        {name: 'banana'},
        {name: 'pear'},
        {name: 'pineapple'}
    ],
    edges: [
        {source:0, target:1, weight:1}, //edges linking nodes.Has a source and a target
        {source:1, target:2, weight:2},
        {source:2, target:3, weight:3},
        {source:3, target:4, weight:4},
        {source:4, target:2, weight:5}
        //Important: make sure last source connect back to existing source!
    ]
};


//create svg
var h=300;
var padding=5;
var svg = d3.select(document.getElementById('chapter11').getElementsByClassName('3')[0]).append('svg').attr('width','100%').attr('height',h);
var w = document.getElementsByTagName('svg')[2].offsetWidth;

//Initialize force-directed graph
var force = d3.layout.force()
                .nodes(dataset.nodes)
                .links(dataset.edges)
                .size([w,h])
                .linkDistance([50]) //distance between each node
                .charge([-100]) //how much nodes wanting to escape from each other
                .start();

//Create line to connecting nodes
var edges = svg.selectAll('line')
                .data(dataset.edges)
                .enter()
                .append('line')
                .style('stroke','black')
                .style('stroke-width',function(d){
                    return d.weight;
                });

//Create circle as nodes
var color = d3.scale.category10();

var nodes = svg.selectAll('circle')
                .data(dataset.nodes)
                .enter()
                .append('circle')
                .attr('fill',function(d,i){
                    return color(i);
                })
                .attr('r', 5)
                .call(force.drag);      //start the function to drag circles.

//Define tick: what is going to happen for each time second
force.on('tick',function(){
    edges.attr('x1',function(d){
        return d.source.x; //x1 of edge to be x of source
    }).attr('y1',function(d){
        return d.source.y //y1 of edge to be y of source
    }).attr('x2',function(d){
        return d.target.x;
    }).attr('y2',function(d){
        return d.target.y;
    });

    nodes.attr('cx',function(d){
        return d.x;
    }).attr('cy',function(d){
        return d.y;
    })
})
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-10.html">Reading Notes for D3.js Part VI (Chapter 10)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-10.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-10.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for <em>Interactive Data Visualization for the Web - An Introduction to Designing with D3</em> by <em>Scott Murray</em>, pulished by <em>O'Reilly, 2013</em></p>
<p>This post will contains concepts that I think it's importa</p>
<h2>Chapter 10 : Interactive Design</h2>
<p>code example for this chapter is <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-VI.html"><strong>here</strong></a>. This part involves lots of code practice.</p>
<p>To add transition to element using <code>css</code>:</p>
<pre class="code literal-block"><span></span><span class="nt">rect</span><span class="nd">:hover</span> <span class="p">{</span>
    <span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
    <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
    <span class="o">-</span><span class="n">o</span><span class="o">-</span><span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
    <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
<span class="p">}</span>
</pre>


<p>We can do same thing using <code>javascript</code>: <code>.on('mouseover',function(){...}</code>; In function, we can use <code>d3.select(this).attr()</code> to adjust attribute of elements. Using <code>.on('mouseout',function(){...}</code> to make sure when moving mouse out, the effect disappears.</p>
<p>Note: It is the best to set <em>hover</em> effect in <code>css</code>, and set other complex effect to <code>javascript</code>.</p>
<p><code>pointer-events: none;</code> can be used to let css <em>ingore</em> mouse event for certain element. <code>.style('pointer-events','none')</code> can achieve same effect.</p>
<h3>Sort Bar</h3>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">sortBars</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">ascending</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span> <span class="c1">//can also do decending</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="p">})</span>
<span class="p">}</span>
</pre>


<p>In the code above, <code>sort</code> needs to know which is front, which is next, so we need to pass it two parameters, and using <code>ascending()</code> to give a order. Now each element in dataset will be compared and sorted.</p>
<h3>Tool Tip</h3>
<p>If you want to use <em>default</em> tooltip setting by browser, just add <code>.append('title').text(function(d){...});</code> after appending elements.</p>
<p>You can also set <em>SVG</em> tooltip. First, re-set <code>x</code> and <code>y</code>, then append <code>text</code> to element:</p>
<pre class="code literal-block"><span></span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mouseover'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">xPosition</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">))</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">randBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="c1">//make tooltip x position to current x plus half of bar width</span>
    <span class="kd">var</span> <span class="nx">yPosition</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">))</span> <span class="o">+</span> <span class="mi">14</span><span class="p">;</span> <span class="c1">//make y go down</span>

    <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'tooltip'</span><span class="p">)</span> <span class="c1">//Assign id for easy remove</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="nx">xPostion</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="nx">yPosition</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'text-anchor'</span><span class="p">,</span><span class="s1">'middle'</span><span class="p">)</span> <span class="c1">//In svg, this is used to align text</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'black'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>

    <span class="c1">//We can remove tooltip by d3.select('#tooltip').remove();</span>
<span class="p">});</span>
</pre>


<p><em>HTML</em> tooltip can make tooltip out of svg, which is better in some case. You can make it using <code>html</code> or <code>javascript</code>.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"tooltip"</span> <span class="na">class</span><span class="o">=</span><span class="s">"hidden"</span><span class="p">&gt;</span>  <span class="c">&lt;!--hidden class can hide this element--&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Label Heading<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span> <span class="na">id</span><span class="o">=</span><span class="s">"value"</span><span class="p">&gt;</span>100<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/css"</span><span class="p">&gt;</span>
    <span class="nn">#tooltip</span><span class="p">{</span>
        <span class="nb">position</span><span class="o">:</span> <span class="nb">absolute</span><span class="p">;</span> <span class="o">//</span><span class="n">This</span> <span class="n">is</span> <span class="n">important</span>
        <span class="nb">width</span><span class="o">:</span> <span class="m">299px</span><span class="p">;</span>
        <span class="nb">height</span><span class="o">:</span> <span class="nb">auto</span><span class="p">;</span>
        <span class="nb">padding</span><span class="o">:</span> <span class="m">10px</span><span class="p">;</span>
        <span class="nb">background-color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
        <span class="o">//...</span>
        <span class="nb">pointer</span><span class="o">-</span><span class="n">events</span><span class="o">:</span><span class="nb">none</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nn">#tooltip</span><span class="nc">.hidden</span><span class="p">{</span>
        <span class="nb">display</span><span class="o">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nn">#tooltip</span> <span class="nt">p</span><span class="p">{</span>
        <span class="nb">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="o">//...</span>
    <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>
    <span class="c1">//re-set xPosition and yPosition as code above</span>

    <span class="c1">//on mouse over</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#tooltip'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'left'</span><span class="p">,</span> <span class="nx">xPosition</span> <span class="o">+</span> <span class="s2">"px"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'top'</span><span class="p">,</span> <span class="nx">yPosition</span> <span class="o">+</span> <span class="s1">'px'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#value'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>

    <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#tooltip'</span><span class="p">).</span><span class="nx">classed</span><span class="p">(</span><span class="s1">'hidden'</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span> <span class="c1">//show tooltip</span>


    <span class="c1">//on mouse out</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#tooltip'</span><span class="p">).</span><span class="nx">classed</span><span class="p">(</span><span class="s1">'hidden'</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre>


<h3>Code for This Chapter</h3>
<p>You can view interative version <a href="http://shanpy.github.io/Front-End-Playground/D3/Reading-D3-VI.html"><strong>here</strong></a>.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">style</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/css"</span><span class="p">&gt;</span>
        <span class="nt">rect</span><span class="nd">:hover</span><span class="p">{</span>
            <span class="n">fill</span><span class="o">:</span><span class="nb">orange</span><span class="p">;</span>
            <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
            <span class="o">-</span><span class="n">o</span><span class="o">-</span><span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
            <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
            <span class="n">transition</span><span class="o">:</span> <span class="n">all</span> <span class="m">0.3s</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nn">#tooltip</span><span class="p">{</span>
            <span class="nb">position</span><span class="o">:</span> <span class="nb">absolute</span><span class="p">;</span>
            <span class="nb">width</span><span class="o">:</span> <span class="m">10em</span><span class="p">;</span>
            <span class="nb">height</span><span class="o">:</span> <span class="nb">auto</span><span class="p">;</span>
            <span class="nb">padding</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
            <span class="nb">background-color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
            <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
            <span class="o">-</span><span class="n">mox</span><span class="o">-</span><span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
            <span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
            <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">3px</span> <span class="m">3px</span> <span class="m">3px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">5</span><span class="p">);</span>
            <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">3px</span> <span class="m">3px</span> <span class="m">3px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">5</span><span class="p">);</span>
            <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">3px</span> <span class="m">3px</span> <span class="m">3px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="o">.</span><span class="m">5</span><span class="p">);</span>
            <span class="nb">pointer</span><span class="o">-</span><span class="n">events</span><span class="o">:</span><span class="nb">none</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nn">#tooltip</span><span class="nc">.hidden</span><span class="p">{</span>
            <span class="nb">display</span><span class="o">:</span> <span class="nb">none</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nn">#tooltip</span> <span class="nt">p</span><span class="p">{</span>
            <span class="nb">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>
    <span class="c1">//create key-value pair dataset</span>
    <span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">base1</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">base2</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">count</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">count</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="nx">count</span><span class="o">++</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">pair</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">base1</span><span class="p">);</span>
        <span class="nx">pair</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">base2</span><span class="p">);</span>
        <span class="nx">dataset</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">pair</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//set up svg</span>
    <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter10'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>         <span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="s1">'100%'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span>

    <span class="c1">//set up scale</span>
    <span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">ordinal</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span>
                    <span class="p">.</span><span class="nx">rangeRoundBands</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">w</span><span class="p">],</span><span class="mf">0.05</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                    <span class="p">})])</span>
                    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>

    <span class="c1">//set up bar chart</span>
    <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
                    <span class="p">})</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">;</span>
                    <span class="p">})</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">();</span>
                    <span class="p">})</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="nx">h</span><span class="o">-</span><span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
                    <span class="p">})</span>
                    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="s2">"rgb(120,150,"</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">;</span>
                    <span class="p">});</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
                        <span class="nx">sortBars</span><span class="p">();</span> <span class="c1">//add a clickable function to it, sorting</span>
                    <span class="p">});</span>

    <span class="c1">//set up tags</span>
    <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'text'</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span><span class="o">+</span><span class="nx">padding</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span>
    <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s1">'black'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'tags'</span><span class="p">);</span>  <span class="c1">//add class for easier sorting</span>


    <span class="c1">//set up axis. Note if axis should be added as last step, otherwise it will mess up tags, and be covered by bars</span>
    <span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">'top'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">yAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
                    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">yScale</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">'right'</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'axis xaxis'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate(0,'</span><span class="o">+</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">)</span><span class="o">+</span><span class="s1">')'</span><span class="p">).</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'g'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'axis yaxis'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'transform'</span><span class="p">,</span><span class="s1">'translate('</span><span class="o">+</span><span class="nx">padding</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="s1">')'</span><span class="p">).</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>


    <span class="c1">//sortBar method</span>
    <span class="kd">var</span> <span class="nx">sortBars</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="c1">//sort rect</span>
         <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'rect'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span>
                <span class="c1">//Important: Use a.value here if your dataset is key/value pair!</span>
                <span class="k">return</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">ascending</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span> <span class="c1">//if pass two parameter a,b, sort them using ascending order</span>
            <span class="p">})</span> <span class="c1">//default is ascending order</span>
            <span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">//after sort, re-asign x value</span>
            <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                        <span class="k">return</span> <span class="s2">"rgb(200,150,"</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">;</span>
                    <span class="p">});</span>

            <span class="c1">//sort tags</span>
            <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">".tags"</span><span class="p">)</span><span class="c1">//selectAll for class name in D3</span>
                <span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">ascending</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
                <span class="p">}).</span><span class="nx">transition</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="c1">//after sort, re-asign x value</span>
                <span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
                            <span class="k">return</span> <span class="s1">'blue'</span><span class="p">;</span>
                        <span class="p">});</span>
    <span class="p">}</span>


    <span class="c1">//Add HTML Reminder</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mouseover'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
        <span class="c1">//get reminder's x and y value</span>

        <span class="c1">//get current current x value and add rangeBand</span>
        <span class="kd">var</span> <span class="nx">xPosition</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">))</span> <span class="o">+</span> <span class="nx">xScale</span><span class="p">.</span><span class="nx">rangeBand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">yPosition</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">))</span> <span class="o">+</span> <span class="nx">h</span><span class="p">;</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'x'</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'y'</span><span class="p">));</span>

        <span class="c1">//create a div to hold reminder. Style for this div is on top</span>
        <span class="kd">var</span> <span class="nx">newDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
        <span class="nx">newDiv</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'tooltip'</span><span class="p">);</span>
        <span class="nx">newDiv</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">'class'</span><span class="p">,</span><span class="s1">'hidden'</span><span class="p">);</span>
        <span class="nx">newDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'&lt;p&gt;&lt;strong&gt;Percentage&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span id="value"&gt;100&lt;/span&gt;%&lt;/p&gt;'</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'chapter10'</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">newDiv</span><span class="p">);</span>

        <span class="c1">//create new reminder</span>
        <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#tooltip'</span><span class="p">).</span><span class="nx">style</span><span class="p">(</span><span class="s1">'left'</span><span class="p">,</span><span class="nx">xPosition</span> <span class="o">+</span> <span class="s1">'px'</span><span class="p">)</span>
                            <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'top'</span><span class="p">,</span> <span class="nx">yPosition</span> <span class="o">+</span> <span class="s1">'px'</span><span class="p">)</span>
                            <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#value'</span><span class="p">)</span>
                            <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span> <span class="c1">//select id as value, then assign d.value to it</span>
        <span class="c1">//now show tooltip</span>
        <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#tooltip'</span><span class="p">).</span><span class="nx">classed</span><span class="p">(</span><span class="s1">'hidden'</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="c1">//If mouse move out, hide tooltip</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mouseout'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#tooltip'</span><span class="p">).</span><span class="nx">classed</span><span class="p">(</span><span class="s1">'hidden'</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span> <span class="c1">//re-add class by using classed()</span>
    <span class="p">});</span>

<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/reading-d3-1-to-5.html">Reading Notes for D3.js Part I (Chapter 1 to Chapter 5)</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/reading-d3-1-to-5.html#disqus_thread" data-disqus-identifier="cache/posts/2014/reading-d3-1-to-5.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/d3js.html" rel="tag">D3.js</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>This is a Reading Note for "Interactive Data Visualization for the Web - An Introduction to Designing with D3" by <em>Scott Murray</em>, pulished by O'Reilly</p>
<p>This post will contains concepts that I think it's important for me to be familiar with in D3 book.</p>
<h2>Chapter 2: D3 Introduction</h2>
<p>D3 is a short-name for <em>Data-Driven Documents</em>. The data is from data provider (users, customers, etc) and the documents are documents based on web, such as HTML, SVG.</p>
<p>The process that D3 create data-driven document is:</p>
<ul>
<li>
<p>Load data to browser cache</p>
</li>
<li>
<p>Bind data to elements in document, and create new element if need</p>
</li>
<li>
<p>Analysis bound datum for each element and set up virtualization attribute. Finish transforming element.</p>
</li>
<li>
<p>Transitioning element based on user input</p>
</li>
</ul>
<p>Transforming is very important. You will need to create transforming rule in this step.</p>
<p>D3.js is great for explaining data instead of exploring data.</p>
<p>D3.js will not hide you original data in client side.</p>
<h2>Chapter 3: Basic Skill in Web</h2>
<p>GeoJSON is similar to JSON, specailly for geograpic data, like points(longitude, latitude) or shapes.</p>
<p>Make sure not decling too many global object. All global variables are attributes for <code>window</code> object. You can declare one or few gloal object then assign attribute to this global object.</p>
<p>In SVG, if <code>x</code> is getting larger, graph will move towards <em>right</em>. If <code>y</code> is getting larger, graph will move towards <em>bottom</em>.</p>
<h3>Graphs in SVG:</h3>
<p><code>rect</code>: <code>x</code> and <code>y</code> is the location of left top corner.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">rect</span> <span class="na">x</span><span class="o">=</span><span class="s">"0"</span> <span class="na">y</span><span class="o">=</span><span class="s">"0"</span> <span class="na">width</span><span class="o">=</span><span class="s">"500"</span> <span class="na">height</span><span class="o">=</span><span class="s">"50"</span><span class="p">/&gt;</span>
</pre>


<p><code>circle</code>: <code>cx</code> and <code>cy</code> is the location of center of circle. <code>r</code> is radius.</p>
<p><code>ellipse</code>: similar to <code>circle</code>, but instead of <code>r</code>, it needs <code>rx</code> and <code>ry</code>.</p>
<p><code>line</code>: <code>x1</code> and <code>y1</code> is used for location of starting point. <code>x2</code> and <code>y2</code> is used for location of end point. <em>You must use <code>stroke</code> to assign color to line so you can see it</em>.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">line</span> <span class="na">x1</span><span class="o">=</span><span class="s">"0"</span> <span class="na">y1</span><span class="o">=</span><span class="s">"0"</span> <span class="na">x2</span><span class="o">=</span><span class="s">"500"</span> <span class="na">y2</span><span class="o">=</span><span class="s">"0"</span> <span class="na">stroke</span><span class="o">=</span><span class="s">"black"</span><span class="p">/&gt;</span>
</pre>


<p><code>text</code>: creatign text. <code>x</code> is the left top corner of text, <code>y</code> is the base line of text. Letters like <em>p</em> or <em>y</em> have parts that are under base line. <code>font-family | font-size | etc</code> can be used to add style to text.</p>
<h3>Style/Attribute for SVG Element</h3>
<p><code>fill</code>: fill color</p>
<p><code>stroke</code>: border color</p>
<p><code>stroke-width</code>: width of border</p>
<p><code>opacity</code>: how transparent the graph will be</p>
<p>You can also assign <code>.class</code> to svg element for style. Same attributes will apply:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">circle</span> <span class="na">cx</span><span class="o">=</span><span class="s">"50"</span> <span class="na">cy</span><span class="o">=</span><span class="s">"50"</span> <span class="na">r</span><span class="o">=</span><span class="s">"50"</span> <span class="na">class</span><span class="o">=</span><span class="s">"test"</span><span class="p">/&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/css"</span><span class="p">&gt;</span>
    <span class="nc">.test</span><span class="p">{</span>
        <span class="n">fill</span><span class="o">:</span> <span class="nb">red</span><span class="p">;</span>
        <span class="n">stroke</span><span class="o">:</span> <span class="nb">yellow</span><span class="p">;</span>
        <span class="n">stroke</span><span class="o">-</span><span class="nb">width</span><span class="o">:</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</pre>


<p>In SVG, there is no layer or <code>z-index</code>, so the sequence that elements are inserted is the sequence of the real graph. They can be partially or fully covered by other graphs.</p>
<p>It is really important to check if user's browser supports SVG or not first. <em>Modernizr</em> (http://modernizr.com) can be used for this.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"path_to_modernizr.js"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>
    <span class="nx">Modernizr</span><span class="p">.</span><span class="nx">load</span><span class="p">({</span>
        <span class="nx">test</span><span class="o">:</span> <span class="nx">Modernizr</span><span class="p">.</span><span class="nx">svg</span> <span class="o">&amp;&amp;</span> <span class="nx">Modernizr</span><span class="p">.</span><span class="nx">inlinesvg</span><span class="p">,</span>
        <span class="nx">yep</span> <span class="o">:</span> <span class="p">[</span>
            <span class="nx">path_to_d3</span><span class="p">.</span><span class="nx">js</span><span class="p">,</span> <span class="nx">path_to_other_css_file</span>
        <span class="p">]</span>
    <span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre>


<h2>Chapter 4: Install D3.js</h2>
<p>It is important to set <code>&lt;meta charset="utf-8"&gt;</code> for correctly compile D3.js.</p>
<h2>Chapter 5: Data</h2>
<p><code>.select("tag_name")</code>: reference the first element that has tag_name.</p>
<p><code>.text("content_of_text")</code>: insert text.</p>
<h3>Use CSV</h3>
<p>D3 can load CSV file via <code>d3.csv()</code>:</p>
<pre class="code literal-block"><span></span><span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s2">"test.csv"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre>


<p>All data, includes number, is saved as string in csv after you load it.</p>
<p><code>d3.csv()/d3.json()/d3.tsv()</code> are <em>asynchromous</em> methods, which means other javascript methods will run <em>at the same</em> time when these method runs. Also, asynchromous will run not matter if the data file is successfully loaded or not.</p>
<p>To avoid any program based on asynchromous, you can declare a global variable first, then call <code>d3.csv()</code> with a <code>error</code> parameter. After finish loading data, if these is no error, assign data to this global variable. Then you can call other functions that should run after successfully load data. Put error handing message if there is any error.</p>
<pre class="code literal-block"><span></span><span class="c">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">code</span> <span class="nx">part</span> <span class="nx">from</span> <span class="nx">book</span> <span class="o">--&gt;</span>
<span class="kd">var</span> <span class="nx">dataset</span><span class="p">;</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s2">"food.csv"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="c1">// Output error message if there is any error</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="c1">// If there is no error, assign loaded data to global variable, then call other functions</span>
        <span class="nx">dataset</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
        <span class="nx">generateVis</span><span class="p">();</span>
        <span class="nx">hideLoadingMsg</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>


<p>To create a new element with data binding, use <code>enter()</code>.This method can create new placefolder if dataset has more elements than existing elements. Next method can operate based on new placeholder(s):</p>
<pre class="code literal-block"><span></span><span class="c">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">code</span> <span class="nx">part</span> <span class="nx">from</span> <span class="nx">book</span> <span class="o">--&gt;</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span> <span class="p">];</span>

<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"body"</span><span class="p">).</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">"p"</span><span class="p">)</span> <span class="c1">//currently no 'p' element exist, but you can select them first.</span>
<span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span> <span class="c1">//bind data in dataset</span>
<span class="p">.</span><span class="nx">enter</span><span class="p">()</span> <span class="c1">//create 5 placeholders</span>
<span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"p"</span><span class="p">)</span> <span class="c1">//insert 'p' element to these 5 placeholders</span>
<span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"New paragraph!"</span><span class="p">);</span> <span class="c1">//each holder has text</span>

<span class="cm">/*</span>
<span class="cm">Result:</span>
<span class="cm">&lt;p&gt;"New paragraph!"&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;"New paragraph!"&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;"New paragraph!"&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;"New paragraph!"&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;"New paragraph!"&lt;/p&gt;</span>

<span class="cm">Each number in dataset is binding to the '__data__' attribute for each 'p' element. You can find it in console. For example, the first 'p' element has a `__data__` attribute. Value is 5.</span>
<span class="cm">*/</span>
</pre>


<p>As long as you use <code>data()</code> method, you can access a anonymous function that has a parameter <code>d</code>. <code>d</code> is the value of the corresponding data in dataset. You can use this function in continous methods whenever you need. For example:</p>
<pre class="code literal-block"><span></span><span class="c">&lt;!--</span><span class="nx">Link</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">code</span> <span class="nx">above</span><span class="o">--&gt;</span>
<span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
<span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
<span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"p"</span><span class="p">)</span>
<span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">fucntion</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="s2">"test "</span> <span class="o">+</span> <span class="nx">d</span><span class="p">;</span>
<span class="p">});</span>

<span class="cm">/*</span>
<span class="cm">Result:</span>
<span class="cm">&lt;p&gt;test 5&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;test 10&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;test 15&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;test 20&lt;/p&gt;</span>
<span class="cm">&lt;p&gt;test 25&lt;/p&gt;</span>
<span class="cm">*/</span>
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/jquery-tutorial-reading-notes.html">jQuery Tutorial Reading Notes</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/jquery-tutorial-reading-notes.html#disqus_thread" data-disqus-identifier="cache/posts/2014/jquery-tutorial-reading-notes.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
           <li><a class="tag p-category" href="categories/jquery.html" rel="tag">jQuery</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<p>If you want to find specific topic, feel free to use <code>ctrl + F</code> to search for keyword.</p>
<p>This is a reading note for <a href="http://www.tutorialspoint.com/jquery">jQuery Tutorial on TutorialsPoint.com</a>, including useful functions/concepts for web development using jQuery. Please note I only pick parts of core concept which I will use most often.</p>
<p>This reading note is based on <code>jQuery 1.3.2</code>.</p>
<h2>Part I : Selectors, Attributes, Traversing</h2>
<h3>Selectors</h3>
<h4>$()/jQuery() function</h4>
<p><code>$()</code> or <code>jQuery()</code> is the format for all selectors in jQuery. It can be applied to:</p>
<ul>
<li>
<p><em>Tag</em>: <code>$('p')</code> selects all paragraphs in document</p>
</li>
<li>
<p><em>#ID</em>: <code>$('#test')</code> select element with ID as test</p>
</li>
<li>
<p><em>.Class</em>: <code>$('.test')</code> select element with ClassName as test</p>
</li>
<li>
<p><em>*</em>: star means universal. This means all DOM elements have been selected</p>
</li>
<li>
<p><em>Mutiple Selectors</em>: results from mutiple selectors can be selected at the same time. For example, <code>$('a#IDs.Classes')</code> means an element with <code>&lt;a&gt;</code> <em>and</em> <code>ID</code> as id <em>and</em> <code>Classes</code> as class name.</p>
</li>
</ul>
<h4>Important Notes</h4>
<ul>
<li>
<p><code>$(XX:not(YY))</code>: select XX elements without YY elements</p>
</li>
<li>
<p><code>$(XX YY)</code>: this means select YY elements which are <em>descendants</em> of XX elements. i.e, inside XX elements</p>
</li>
<li>
<p><code>$(XX YY:first)</code>: select first YY elements which is inside XX</p>
</li>
<li>
<p><code>$(XX &gt; YY)</code>: select YY elements which are children of XX elements</p>
</li>
<li>
<p><code>$(XX + YY)</code>: select YY elements that is the <em>connected</em> following sibling of XX elements.</p>
</li>
<li>
<p><code>$(XX ~ YY)</code>: select YY elements that is the following siblings of XX elements</p>
</li>
<li>
<p><code>$(XX,YY)</code>: select elements that match XX <em>or</em> YY</p>
</li>
<li>
<p><code>$(':empty')</code>:select elements that have no child elements</p>
</li>
<li>
<p><code>$('XX:empty')</code>:select all XX elements that have no child elements</p>
</li>
<li>
<p><code>$('XX[YY]')</code>: select all XX elements that <em>contains</em> an element with attribute YY</p>
</li>
<li>
<p><code>$('XX[@YY]')</code>: select all XX elements that has a YY attribute</p>
</li>
<li>
<p><code>$('XX[@YY=ZZ]')</code>: select all XX elements that has a YY attribute, and attribute value is ZZ</p>
</li>
<li>
<p><code>$('XX[@YY^=ZZ]')</code>: select all XX elements that has a YY attribute, and attribute value <em>begin with</em> ZZ</p>
</li>
<li>
<p><code>$('XX[@YY$=ZZ]')</code>: select all XX elements that has a YY attribute, and attribute value <em>end with</em> ZZ</p>
</li>
<li>
<p><code>$('XX[@YY*=ZZ]')</code>: select all XX elements that has a YY attribute, and attribute value <em>containing</em> ZZ</p>
</li>
<li>
<p><code>$("XX:YY")</code>: YY here can be: <code>even</code>, <code>odd</code>, <code>first</code>, <code>last</code>, <code>visible</code>, <code>hidden</code>, <code>radio</code>, <code>checked</code>, <code>input</code>, <code>text</code>, <code>eq(n)</code> (This mean nth element), <code>li(n)</code> (This means the first nth element), <code>ge(n)</code> (This means after n+1 element), <code>first-child</code>, <code>last-child</code>, <code>contains(YY)</code> (This means contain text YY)</p>
</li>
<li>
<p><code>$(XX/YY)</code>: select YY elements that are child of an element XX</p>
</li>
<li>
<p><code>$(XX//YY)</code> or <code>$(//XX//YY)</code>: select YY elements that are descendants of an element XX</p>
</li>
<li>
<p><code>$(:parent)</code>:all elements that are <em>parents</em> of another element, including <code>text</code></p>
</li>
</ul>
<h3>DOM Attributes</h3>
<p>Some of most import DOM attributes are: <code>className</code>, <code>tagName</code>, <code>id</code>, <code>href</code>, <code>title</code>, <code>rel</code>, <code>src</code></p>
<p><em>Get Attribute Value</em>: <code>.attr()</code>. For example: <code>var title = $(#testId).attr('title');</code>. Element testId should be <code>&lt;XX titile="..."/&gt;</code></p>
<p><em>Set Attribute Value</em>: <code>.attr(name,value)</code>. For example, <code>$("#testId").attr('src','/image.jpg');</code></p>
<p><em>Set Mutiple Attribute Value</em>: <code>.attr({key:value, key:value})</code>:</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">'#testId'</span><span class="p">).</span><span class="nx">attr</span><span class="p">({</span>
    <span class="nx">src</span><span class="o">:</span> <span class="sb">`/image.png`</span><span class="p">,</span>
    <span class="nx">alt</span><span class="o">:</span> <span class="s1">'images'</span><span class="p">,</span>
    <span class="nx">style</span><span class="o">:</span> <span class="sb">`display:auto;`</span>
<span class="p">});</span>
</pre>


<p><em>Set Attribbute with Function</em>: <code>.attr(key, function(){...});</code></p>
<p><em>Remove Attribute</em>: <code>.removeAttr(Attr_Name);</code></p>
<p><em>Set Class</em>: <code>.addClass()</code>. You may want to define the style for this class first in style sheet. For example, <code>$(#testId).addClass('main');</code></p>
<p><em>Remove Class</em>: <code>.removeClass(Class_Name);</code></p>
<p><em>Judge if Exists Class</em>: <code>XX.hasClass(Class_Name)</code>. Return true if as least one of XX element has this specific class</p>
<p><em>Add/Remove Class</em>: <em>.toggleClass(Class_name)</em>. Add class if not exist. Remove class if it exists.</p>
<p><em>Get Content</em>: <code>.html()</code>. Get html content of the <em>first</em> matched element. Equals to <code>xx.getInnerHTML();</code></p>
<p><em>Set Context</em>: <code>.html(val)</code>. For example: <code>var test = "&lt;p&gt;Test&lt;/p&gt;. $('#testId').html(test)"</code> means assign content in test to element testId.</p>
<p><em>Get All Text Content</em>: <code>.text()</code>. Get the <em>combined</em> text contents of all matched elements.</p>
<p><em>Set Text Contents to All</em>: <code>.text(val)</code>. Set the text contents of all matched elements.</p>
<p><em>Get Value</em>: <code>.val()</code> get the input value of the first matched element</p>
<p><em>Set Value</em>: <code>val(val)</code>. If applied to <code>input</code>, set the value of all input field. If applied to <code>select</code> and passign <code>option</code> value, that option is selected. If applied to <code>checkbox</code> or <code>radiobutton</code>, all match checkbox or radiobutton are selected.</p>
<h3>DOM Traversing</h3>
<h4>For Table Lists</h4>
<p><code>.eq(index)</code>: find the <em>index+1</em>th element, since we count staring from 0.</p>
<p><code>.filter(selector)</code>: remove all elements which not match to selector</p>
<p><code>.filter(function)</code>: remove all elements which not match to function</p>
<p><code>XX.is(selector)</code>: return true if at least one element of XX fits the selector</p>
<p><code>XX.map(callback)</code>: transfer XX to a jQuery array, following callback</p>
<p><code>.not(selector)</code>: remove all elements which match to the selector</p>
<p><code>.slice(start, [end])</code>: select a subset of matched elements. Starting for <em>0</em>.</p>
<p><em>End is exclusive</em>. If using nagative number, it means starting from the end of selection.</p>
<h4>Others</h4>
<p><code>XX.add(selector)</code>: add more elements to XX, which matches the selector.</p>
<p><code>XX.selector.andSelf().Do-something</code>: Do something to elements in selector, and XX itself:</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">p</span><span class="p">).</span><span class="nx">andSelf</span><span class="p">().</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">"border"</span><span class="p">);</span>
<span class="c1">//Add border to all paragraphs, and all divs themselves</span>
</pre>


<p><code>XX.children(selector)</code>: select <em>sons</em> of XX which matches selector</p>
<p><code>XX.closest(selector)</code>: First check if XX matches selector, if so return XX. Otherwise find XX's cloest <em>parent</em> element which matches the selector, and return this element.</p>
<p><code>.contents()</code>: Applies to <code>iframe</code>. Get all contents (i.e. child nodes) of iframe.</p>
<p><code>XX.end()</code>: revert XX to its previous state.</p>
<p><code>.find(selector)</code>: find all <em>descedent</em> elements that match selector</p>
<p><code>.next(selector)</code>: find first <em>sibling</em> which match the selector</p>
<p><code>.nextAll()/.nextAll(selector)</code>: find all <em>siblings</em>. Can add selector as parameter</p>
<p><code>XX.offsetParent()</code>: return the <em>first</em> parent of XX elements.</p>
<p><code>parent()/parent(selector)</code>: reutrn the direct parent of element. Can add selector as parameter</p>
<p><code>prev()/prev(selector)</code>: return <em>closest</em> previous sibling (which matches the selector).</p>
<p><code>prevAll()/prevAll(selector)</code>: return previous siblings (which matches the selector).</p>
<p><code>siblings()/siblings(selector)</code>: return siblings (which matches the selector).</p>
<h2>Part II : CSS, DOM, Events</h2>
<h3>CSS Methods</h3>
<p><em>Apply CSS Properties</em>: <code>XX.css(PropertyName, PropertyValue);</code>. For example, <code>$("#testId").css("display","none");</code></p>
<p><em>Apply Multiple CSS Properties</em>: <code>.css({key:value, key:value...})</code>:</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">'#testId'</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
    <span class="s2">"color"</span> <span class="o">:</span> <span class="s2">"red"</span><span class="p">,</span>
    <span class="s2">"background-color"</span><span class="o">:</span> <span class="s2">"blue"</span>
<span class="p">});</span>
</pre>


<p><em>Apply Width and Height</em>: <code>.width(Number)</code> and <code>.height(Number)</code> can be used directly</p>
<p _="%" images_posts_jquery-css-methods.png="images/posts/jQuery-css-methods.png" img>jQuery CSS Methods:</p>
<h3>DOM Manipulation Methods</h3>
<p><em>Content Manipulation</em>: <code>.html()</code>. Please refer <a href="jquery-reading-note-I">Reading Note I</a> for usage.</p>
<p><em>DOM Element Replacement</em>: <code>XXX.replaceWith(content)</code>. XXX DOM element is replaced by content.</p>
<p><em>DOM Remove</em>: <code>XXX.empty()</code> remove all child elements from XXX elements. <code>XXX.remove(selector)</code> remove all matched elemetns from DOM.</p>
<p><em>DOM Insert</em>: <code>XXX.before(content)</code> or <code>XXX.after(content)</code>.</p>
<p _="%" images_posts_dom-manipulation-methods.png="images/posts/DOM-Manipulation-Methods.png" img>Other DOM Manipulation Methods:</p>
<h3>Event Handling</h3>
<h4>Binding Event Handlers</h4>
<p><code>selector.bind(eventType, handler)</code> or <code>selector.bind(eventTpe, eventData, handler)</code></p>
<p><code>eventType</code> is the action, such as <code>click</code> or <code>submit</code></p>
<p><code>eventData</code> is <em>optional</em>.</p>
<p><code>handler</code> is the function trriger for this event.</p>
<h4>Remove Event Handlers</h4>
<p><code>selector.unbind(eventType, handler)</code> or <code>selector.unbind(eventType)</code></p>
<p><code>eventType</code>: same as above</p>
<p><code>handler</code>: the handler that you want to remove</p>
<h4>Event Types</h4>
<p>{% img images/posts/event-type.png %}</p>
<h4>Event Object and Attributes</h4>
<p><code>event</code> can be used as a parameter in handler callback function. There are several attributes that can be retrived by using <code>event.attributeName</code>. These attribute name returns useful values.</p>
<p>Example:</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">'#testId'</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span> <span class="c1">//here event parameter means the 'click' object</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">pageX</span><span class="p">);</span> <span class="c1">//type and pageX are attributes for event object</span>
<span class="p">});</span>
</pre>


<p _="%" images_posts_event-attributes.png="images/posts/event-attributes.png" img>List of Attributes:</p>
<h4>Event Methods</h4>
<p _="%" images_posts_event-methods.png="images/posts/event-methods.png" img><code>event</code> parameter can also run some methods to perform specific function. To use it, just do <code>event.XXX();</code> in callback function. Here is a list of event methods:</p>
<p>Please note <code>preventDefault()</code> is to prevent current function function working on current element, but <code>stopPropagation()</code> is to prevent <em>parent element's function</em> working on current element.</p>
<h4>Event Manipulation Methods</h4>
<p _="%" images_posts_event-manipulation-methods.png="images/posts/event-manipulation-methods.png" img>There are other methods besides <code>bind()</code>, which can be used for jQuery events. Here is a list of them:</p>
<p><code>hover(over, out)</code>: <code>over</code> and <code>out</code> can be replaced by two functions that you want to perform.</p>
<h4>Event Helper Methods</h4>
<p>To trigger an event function YY on XX element, just use <code>XX.YY();</code></p>
<p _="%" images_posts_binding-methods.png="images/posts/binding-methods.png" img>There are some already defined methods that you can use <code>XX.YY()</code> format to add event to XX element. For example, <code>$("#testId").click(function(){ ... });</code>. Here is a list:</p>
<h2>Part III : Ajax, Effects</h2>
<h3>Ajax</h3>
<p>AJAX means <em>Asynchromous JavaScript and XML</em>. It can help load data from server without having to refresh whole page.</p>
<p><code>XX.load(URL, Optional:data, Optional:callback)</code> is used to load data:</p>
<ul>
<li>
<p>URL: can be <code>CGI</code>, <code>ASP</code>, <code>JSP</code> or <code>PHP</code> script which generate data from database.</p>
</li>
<li>
<p>data: <em>Optional</em>. if this is ommitted, <code>GET</code> method is used. If specified, <code>POST</code> method is used.</p>
</li>
<li>
<p>callback: callback function to deal with data after loading. The first parameter passed to this function is the <em>response text</em> received from the server and second parameter is <em>status code</em>.</p>
</li>
</ul>
<h4>Get JSON Data</h4>
<p><code>XXX.getJSON(URL, Optional:data, Optional:callback)</code> is used to get JSON string:</p>
<ul>
<li>
<p>URL: the server-side source which can be reach via <code>GET</code> method.</p>
</li>
<li>
<p>data: <em>Optional</em>. You can pass <code>name/value</code> pair to do sring query.</p>
</li>
<li>
<p>callback: <em>Optional</em>. Call back function to deal with data after loading. The first parameter is the <em>JSON string</em> which is passed back based on request. The second parameter is the <em>status code</em>.</p>
</li>
</ul>
<h4>Pass Data to Server</h4>
<p>You can use <code>data</code> parameter to pass data to server via any ajax call. For example:</p>
<pre class="code literal-block"><span></span><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#name'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">'#stage'</span><span class="p">).</span><span class="nx">load</span><span class="p">(</span><span class="s1">'/jquery/result.php'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'name'</span><span class="o">:</span><span class="nx">name</span><span class="p">});</span>
</pre>


<h4>jQuery Ajax Methods and Events</h4>
<p>{% img images/posts/ajax_methods_events.png %}</p>
<h3>Events</h3>
<h4>Show or Hiding or Toggle Elements</h4>
<p><code>XXX.show(speed,Optional:callback)</code> is used to show the elements. <code>speed</code> can be <code>slow</code>, <code>normal</code>, <code>fast</code> or any milliseconds. <code>callback</code> is optional. You run this function after the animation completes.</p>
<p><code>XXX.hide(speed,Optional:callback)</code> is the same as above:</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">'#testDIV'</span><span class="p">).</span><span class="nx">hide</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>
</pre>


<p><code>XXX.toggle(Optional:speed, Optional: callback)</code> is used to toggel elements.</p>
<h4>Other jQuery Events</h4>
<p>{% img images/posts/jquery_events.png %}</p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/2014/bootstrap3-api-reading-notes.html">Bootstrap3 API Reading Notes</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-12-10T00:00:00-05:00">2014-12-10 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/2014/bootstrap3-api-reading-notes.html#disqus_thread" data-disqus-identifier="cache/posts/2014/bootstrap3-api-reading-notes.html">Comments</a>


                </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/bootstrap3.html" rel="tag">Bootstrap3</a></li>
           <li><a class="tag p-category" href="categories/css.html" rel="tag">CSS</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">JavaScript</a></li>
           <li><a class="tag p-category" href="categories/jquery.html" rel="tag">jQuery</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>This post is transferred from my <a href="http://blogpengyin.herokuapp.com/">old Hexo blog site</a>, created on 2014.</p>
<h2>CSS Part</h2>
<p>This is a reading note for Bootstrap 3 Official API CSS part, including everything I think that will be useful for future web development.</p>
<p>Bootstrap3 needs to have <code>&lt;!DOCTYPE html&gt;</code> on top for html5 recogization purpose.</p>
<p>Bootstrap3 has "Mobile first" principle, so <code>&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;</code> should be added in <code>&lt;head&gt;</code> tag.</p>
<p>Bootstrap3 <strong>requires</strong> a container to hold all codes. so make sure add it before insert any more codes. Containers can not be nested:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"container"</span><span class="p">&gt;</span>
...
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="c">&lt;!--Or use this for a full width of device--&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"container-fluid"</span><span class="p">&gt;</span>
...
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h3>Grid System</h3>
<p>In Aug 2014, I read a very good tutorial about grid system in bootstrap3 from http://www.tutorialrepublic.com/twitter-bootstrap-tutorial and wrote some notes:</p>
<ul>
<li>
<p>12 content boxes in all devices</p>
</li>
<li>
<p>mobile deivce has 1 column and 12 rows; tablet has 2 column and 6 rows</p>
</li>
<li>
<p>desktop has 3 column and 4 rows</p>
</li>
<li>
<p>large desktop has 4 column and 3 rows</p>
</li>
<li>
<p>if col-md-* is different for each column, <code>.clearfix</code> help with reduce visible block to make sure 12 column grid</p>
<p>:::html
<!--First two lines has total grid of 6X2 = 12 grids, so use clearfix for next line. This row will have two equal width column-->
</p>
<div class="row">
<div class="col-md-6"><p>Box</p></div>
<div class="col-md-6"><p>Box</p></div>
<div class="clearfix visible-md-block"></div>
</div>
<p><!--First two lines has total grid of 4X3 = 12 grids, so use clearfix for next line. This row will have three equal width column-->
</p>
<div class="row">
<div class="col-md-4"><p>Box</p></div>
<div class="col-md-4"><p>Box</p></div>
<div class="col-md-4"><p>Box</p></div>
<div class="clearfix visible-md-block"></div>
</div>
</li>
</ul>
<p>Responsive utility class <code>.visible-md/xs/sm/lg-block</code> make <code>.clearfix</code> effectly only in special scale device. For example, if <code>.visible-xs-block</code>, this block will only be viewed on xs device(phone)</p>
<p>As a conclution, The way <code>clearfix visilbel-xs/sm/md/lg</code> work is everytime when a 12 grid appears, a <code>clearfix visible-XX-block</code> without any content <em>needs to appear</em>. For example:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-sm-6 col-md-4 col-lg-3"</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Box 1<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-sm-6 col-md-4 col-lg-3"</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Box 2<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"clearfix visible-sm-block"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="c">&lt;!--There are 6*2=12 grids already, insert a clearfix with sm--&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-sm-6 col-md-4 col-lg-3"</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Box 3<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"clearfix visible-md-block"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="c">&lt;!--There are 4*3=12 grids already, insert a clearfix with md --&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-sm-6 col-md-4 col-lg-3"</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Box 4<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"clearfix visible-sm-block"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="c">&lt;!--Another 6*2 appears, so insert another clearfix with sm--&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"clearfix visible-lg-block"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="c">&lt;!--There are 3*4 grid, so use clearfix with large--&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p><code>xs</code>: less than 768px; sm: 768 to 992; md: 992 to 1200; lg: larger than 1200</p>
<p>Similar as visible, there are <code>.hiddle-xs</code>, <code>.hidden-sm</code> <code>.hidden-md</code> and <code>.hidden-lg</code>, hide in special scale</p>
<p>Similarly there is print class: <code>.visible-print-block</code>: when print, hide block elements; <code>.visilble-print-inline/.visible-print-block</code>: hide inline/inline-block in print; <code>.hiddle-print</code>: hide elements in print</p>
<p>Other useful things that I got from Bootstrap offical API about Grid System is:</p>
<ul>
<li>
<p>The gap between columns is adjusted by <strong>padding</strong>.</p>
</li>
<li>
<p>If more than 12 columns in a row, extra columns will be put to new line as one unit.</p>
</li>
<li>
<p>If there is no <code>col-lg-</code>, then styles that apply to <code>col-md-</code> will also affect page on large device.</p>
</li>
</ul>
<p>Place grid columns in any <code>class="row"</code>:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"container-fluid"</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
    ...
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="c">&lt;!-- `.col-md-offset-*` can be used to move columns to the right. `*` is how many columns this column moves: --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-md-4"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-md-4 col-md-offset-4"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- last column will move to right, starting from the 9th column --&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p>It is safe to use <strong>nested column</strong>. But make sure <code>class="row"</code> is added to nested part.</p>
<h2>Components Part</h2>
<h3>Pannels*</h3>
<p>Table or List can be added in panel body for format.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel panel-default"</span><span class="p">&gt;</span>
<span class="c">&lt;!--panel-default can be changed to panel-primary, panel-success, etc--&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-heading"</span><span class="p">&gt;</span>This page is disabled<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!--The way to define pannel heading--&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-body"</span><span class="p">&gt;</span>
    TextTest
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-footer clearfix"</span><span class="p">&gt;</span>
    <span class="c">&lt;!--add panel footer--&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"pull-right"</span><span class="p">&gt;</span>
        <span class="c">&lt;!--This will make footer to the right of the panel--&gt;</span>
            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span><span class="p">&gt;</span>Learn More<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p>It is useful to put pannel with tables or list-groups. Just make <code>.panel</code> class wrap <code>.panel-heading</code>, <code>.panel-body</code>, and <code>.table</code>or<code>.list-group</code>.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel panel-default"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-heading"</span><span class="p">&gt;</span>Panel Heading<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-body"</span><span class="p">&gt;</span>Panel Body<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"list-group"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"list-group-item"</span><span class="p">&gt;</span>Item One<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h3>Breadcrumb</h3>
<p>A breadcrumb is a navigation scheme that indicates the user's location in a website or web application. For example: <code>Home/Library/Data</code>.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"breadcrumb"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>Home<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>Products<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"active"</span><span class="p">&gt;</span>Accessories<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre>


<h3>Pagination (Page Number Indicator)</h3>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"pagination pagination-sm"</span><span class="p">&gt;</span>
<span class="c">&lt;!--'pagination-sm' can be skipped or change to -xs/-lg, etc. This is used to define size of pagination--&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span><span class="ni">&amp;laquo;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- Left page arrow--&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"disabled"</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>1<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="c">&lt;!--item can be disabled--&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"active"</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>2<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="c">&lt;!--Active Page Number--&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span><span class="ni">&amp;raquo;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="err">&lt;</span>
    !-- Right page arrow--&gt;
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre>


<p>Bootstrap3 also have <em>previous/next</em> indicator, which is called <em>Pager</em></p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"pager"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"previous"</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span><span class="ni">&amp;larr;</span> Previous<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- two class can make button aligned to left and right of window. &amp;larr is a left arrow --&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"next disabled"</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>Next <span class="err">&amp;</span>rarr<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- pager can be disabled --&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre>


<h3>Labels and Badges</h3>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Bootstrap heading
<span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"label label-default"</span><span class="p">&gt;</span>New<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="c">&lt;!-- create inline label 'new' for heading. 'label-default' can be replaced with label-success, etc --&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>Notification <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"badge"</span><span class="p">&gt;</span>5<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="c">&lt;!-- badge is the number indicator for email or notification button. For example, a 5 will show if there are 5 notifications --&gt;</span>
</pre>


<h3>Progress Bar</h3>
<pre class="code literal-block"><span></span><span class="c">&lt;!-- .progress-stripped is a class to make colorful effect. .active is a class to make animate effect --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"progress progress-stripped active"</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- process-bar-success can be replaced by process-bar-warning, etc --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"progress-bar process-bar-success"</span> <span class="na">style</span><span class="o">=</span><span class="s">"width: 60%"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"sr-only"</span><span class="p">&gt;</span>20% Complete<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p>Process bar can also add label to indicate the numbered process. Reference: http://getbootstrap.com/components/#progress-label.</p>
<h3>Jumbotron</h3>
<p>Jumbotron is used as a header panel with important content, that can be put on top of homepage. For example, a Header combined with a paragraph and a read-more button</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"jumbotron"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Welcome to Website<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Key Notes: XXX...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">'#'</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span><span class="p">&gt;</span>LearnMore<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h3>Wells</h3>
<p>Wells componet make a part of content like sink in well. Used for static text.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"well well-large/well-small"</span><span class="p">&gt;</span>
In a well...
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h3>Close icons</h3>
<p>A X icon on right of panel so that user can close this panel after read it</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-warning"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span> <span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Warning!<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> There is a problem
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h3>Bootstarp3 Help Class</h3>
<p><code>.pull-left/.pull-right</code> will floats an element to left or right</p>
<p><code>.text-muted</code> make a element grayed out by change its color value</p>
<p><code>.clearfix</code> clear the float of any element</p>
<h3>Buttons</h3>
<h4>Available Classes:</h4>
<p><code>btn-default/primary/info/success/warning/danger/link</code>: define attributes of button</p>
<p><code>btn-lg/sm/xs</code>: define size of button</p>
<p><code>btn-block</code>: define a button that covers full width of parent element</p>
<p><code>diabled</code>: disable a button</p>
<p><code>data-loading-text="Loading..."</code>: can be add when a button is in loading state (automatically turn off in firefox)</p>
<p>Toggle Button (hover effect): <code>data-toggle="button"</code></p>
<h4>Button group:</h4>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn-group/btn-group-vertical btn-group-lg/sm/xs"</span><span class="p">&gt;</span>
<span class="c">&lt;!-- Can add btn-group-justified to make group buttons alignment justified --&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span><span class="p">&gt;</span>Left<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span><span class="p">&gt;</span>Right<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn-group"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-default dropdown-toggle"</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">"dropdown"</span><span class="p">&gt;</span>
        Button Group can be nested
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p><code>.button-toolbar</code>: class that wrap several <code>.button-group</code>s.</p>
<p>Justified button groups: use <code>.btn-group-justified</code>. You must <strong>wrap each button in a button-group</strong>:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn-group btn-group-justified"</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn-group"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-default"</span><span class="p">&gt;</span>Test Button1<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn-group"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-default"</span><span class="p">&gt;</span>Test Button2<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h4>Available Methods for Button</h4>
<p><code>$().button('toggle')</code>: change any button to toggle state</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'#myButton'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">button</span><span class="p">(</span><span class="s1">'toggle'</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">});</span>
</pre>


<p><code>$().button('loading')</code>: when loading, button is disabled and text is swapped with the value of 'data-loading-text' attribute of button element</p>
<p><code>$().button('reset')</code>: reset button state by swapping text to original text</p>
<p><code>$().button(string)</code>: reset button to show this string</p>
<h3>Dropdown</h3>
<p>Dropdown can be done within navabar, nav or buttons. Reference: http://getbootstrap.com/components/#btn-dropdowns-single</p>
<pre class="code literal-block"><span></span><span class="c">&lt;!-- 'nav nav-pills' is nav, 'btn-group' is button --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"navbar navbar-static"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"navbar-inner"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">'#'</span> <span class="na">class</span><span class="o">=</span><span class="s">"First"</span><span class="p">&gt;</span>
        First
        <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">role</span><span class="o">=</span><span class="s">"navigation"</span> <span class="na">class</span><span class="o">=</span><span class="s">"nav"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown"</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">"dropdown"</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown-toggle"</span><span class="p">&gt;</span>
                First Dropdown <span class="p">&lt;</span><span class="nt">b</span> <span class="na">class</span><span class="o">=</span><span class="s">"caret"</span><span class="p">&gt;&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown-menu"</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">'#'</span><span class="p">&gt;</span>Second Dropdown<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                    <span class="c">&lt;!-- &lt;li class='divider'&gt;&lt;/li&gt; can be add here if a button dropdown needs a divider --&gt;</span>
                <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="c">&lt;!-- a button can be directly used as dropdown: &lt;button data-toggle...&gt;Dropdown &lt;span class="caret"&gt;&lt;/span&gt;&lt;/button&gt; --&gt;</span>
</pre>


<h4>Available Methods for Dropdown</h4>
<p><code>$().dropdown('toggle')</code>: toggle item for a given dropdown</p>
<h4>Available Events for Dropdown</h4>
<p><code>show.bs.dropdown</code>: trigger when show instance method is called. can be reached by <code>event.relatedTarget</code></p>
<p><code>shown.bs.dropdown</code>: triger when a dropdown is visible. Will wait for css.
can be reached by event.relatedTarget</p>
<p><code>hide.bs.dropdown/hidden.bs.dropdown</code>: same except hide instance</p>
<pre class="code literal-block"><span></span><span class="c1">//After click ok button, dropdown will be expanded</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">".dropdown"</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">"show,bas.dropdown"</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">linkedText</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">relatedTarget</span><span class="p">).</span><span class="nx">text</span><span class="p">();</span>
        <span class="c1">//linkedText will be firstClass item in dropdown</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">"Click on OK button to view the dropdown menu for -"</span> <span class="o">+</span> <span class="nx">linkText</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">});</span>
</pre>


<h3>Tooltip</h3>
<p>For performance reasons, tooltip must be initialized first</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">".classOfItem a"</span><span class="p">).</span><span class="nx">tooltip</span><span class="p">();</span>
    <span class="c1">//Assume that structure of item is .classOfItem &lt;a&gt;...&lt;/a&gt;</span>
<span class="p">});</span>
</pre>


<p>Trigger while set position of tooltip</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="s2">".classOfItem"</span><span class="p">).</span><span class="nx">tooltip</span><span class="p">({</span><span class="nx">placement</span><span class="o">:</span> <span class="s1">'top/right/buttom/left'</span><span class="p">});</span>
</pre>


<h4>Available Method for Tooltip</h4>
<p><code>$().tooltip(options)</code>: attach tooltip to elements, options can be found online, include titile, delay, etc</p>
<p><code>$().tooltip('show'/'hide'/'toggle'/'destory')</code>: show/hide/toggle/destroy tooltip</p>
<h3>Popover</h3>
<p>Popover is like tooltip but is a panel with header and body content. It also needs to be initialize first</p>
<pre class="code literal-block"><span></span><span class="err">#</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="nx">funtion</span><span class="p">(){</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">".classOfItem a"</span><span class="p">).</span><span class="nx">popover</span><span class="p">();</span>
    <span class="c1">//Same as tooltip. Popover can set position when triggered. See tooltip part for detail</span>
<span class="p">});</span>
</pre>


<p>Popover has similar method as tooltip: options/show/hide/toggle/destroy.</p>
<h3>Alerts</h3>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-warning"</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 'alert-warning' can be changed to error/success/info --&gt;</span>
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- enable close button for this alert message. Need JavaScript plugin--&gt;</span>
    <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Warning!<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>There was a problem!
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p><code>.alert-link</code> adds link in alerts:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert"</span> <span class="na">role</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span>
  You must click <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert-link"</span><span class="p">&gt;</span>Link to other url<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> !
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h4>Available Methods for Alerts</h4>
<p><code>$().alert</code>: wrap all alert with close functionality</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(.</span><span class="nx">close</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">".alert"</span><span class="p">).</span><span class="nx">alert</span><span class="p">();</span>
<span class="p">});</span>
</pre>


<p><code>$().alert('close')</code>: close a alert box</p>
<h3>Tabs</h3>
<p>To use tab in nav bar, create <code>&lt;ul&gt;</code> with <code>class="nav nav-tab"</code> and each <code>&lt;li&gt;</code> has a <code>href</code></p>
<p>Tabs can be add dynamically with any javascript: simply specify the <code>data-toggle="tab"</code> on each tab, as well as create a <code>.tab-pane</code> with unque ID for every tab and wrap them in <code>.tab-content</code>.</p>
<p>Create dynamic tab with javascript:</p>
<pre class="code literal-block"><span></span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">"#myTab a"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
        <span class="c1">//Note this function is defined on a href link</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">tab</span><span class="p">(</span><span class="s1">'show'</span><span class="p">);</span>
        <span class="c1">//Method to activate a tab using .tab('show')</span>
        <span class="p">});</span>
<span class="p">});</span>
</pre>


<h2>Form Part</h2>
<p>Any element with <code>.form-control</code> has <code>width:100%;</code> by default.</p>
<p>You can nest the <code>.input-group</code> in <code>.form-group</code> but don't mix them directly.</p>
<p>Vertical Form in Bootstrap3:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-group"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">"example"</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">""</span> <span class="na">id</span><span class="o">=</span><span class="s">"example"</span> <span class="na">class</span><span class="o">=</span><span class="s">'form-control'</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">''</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre>


<p>Inline Form in Bootstrap3 (i.e. For a device that has less than 768px width<code>.xs</code>, the elements that listed inline in larger device will list in block)</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">class</span><span class="o">=</span><span class="s">'form-inline'</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">'form-group'</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">"examle"</span><span class="p">&gt;</span>You must always add labels. You can use .sr-only class to hide it<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">""</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-control"</span> <span class="na">id</span><span class="o">=</span><span class="s">"example"</span><span class="p">/&gt;</span> //Define grid for input area
            <span class="p">&lt;</span><span class="nt">input</span> <span class="err">...</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre>


<h3>Supported Form Controls</h3>
<p>All html5 input type are supported: <code>text</code>, <code>password</code>, <code>datetime</code>, <code>datetime-local</code>, <code>date</code>, <code>month</code>, <code>time</code>, <code>week</code>, <code>number</code>, <code>email</code>, <code>url</code>, <code>search</code>, <code>tel</code>, <code>color</code></p>
<p><code>&lt;fieldset&gt;</code> can be used to wrap a few form-group in order to easily apply style.</p>
<p><code>.disabled</code> can be added to <code>.radio</code> or <code>.checkbox</code> or <code>&lt;fieldset&gt;</code> to disable these elements.</p>
<p><code>.checkbox-inline</code> or <code>.radio-inline</code> create inline-element. They needs to be wrpped in <code>&lt;label&gt;</code>:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">"checkbox-line"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"checkbox"</span> <span class="na">id</span><span class="o">=</span><span class="s">"test"</span> <span class="na">value</span><span class="o">=</span><span class="s">"test"</span><span class="p">&gt;</span> test
    <span class="c">&lt;!-- 'test' here can be skipped if this checkbox don't need any label. But this input must always be wrapped in &lt;label&gt; tag.--&gt;</span>
<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</pre>


<p><code>.form-control-static</code> can be put in a <code>&lt;p&gt;</code> tag to create a text that hold the place as a input field</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-group"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">"test"</span><span class="p">&gt;</span>Test:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-control-static"</span> <span class="na">id</span><span class="o">=</span><span class="s">"test"</span><span class="p">&gt;</span>This is a text<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p>After using Javascript to valid data in input field, '.has-warning',<code>.has-error</code> or <code>.has-success</code> can be added to input fields to show validation result. <code>&lt;span class="glyphicon plyphicon-warning-sign form-control-feedback&gt;</code> can be added after <code>&lt;input&gt;</code> field if optional icons are needed.</p>
<p><code>&lt;span class=".help-block"</code> can add help text under input field</p>
<h3>Input Group</h3>
<p>To add icon, put <code>&lt;span class='input-group-addon'&gt;&lt;/span&gt;</code> inside a input-group class</p>
<p>To add button attched to input, use <code>.input-group-btn</code>for a span and add button in span. Put this span right after input box.</p>
<p>Input group can have height class <code>.input-group-lg</code>.</p>
<h2>Image and Media Part</h2>
<p>Use Bootstrap3 to modify shape of image: <code>.img-rouned</code>,<code>.img-circle</code>,<code>.img-thumbnail</code>.</p>
<p><code>.thumbnail</code> define a div with shape of thumbnail. div can include jpg file. Best use with grid class.</p>
<p>Media Objects: create layout like twitter or Linkedin name signature</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">'media'</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">"pull-left"</span><span class="p">&gt;</span>...
    <span class="c">&lt;!--This part will be left panel, best to put thumbnail in --&gt;</span>
    <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"media-body"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">"media-heading"</span><span class="p">&gt;</span>
        Header
        <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>.
        Body
        <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<p>Reference Glyphicon library: <code>&lt;span class="glyphicon glyphicon-class-name"&gt;&lt;/span&gt;</code>.</p>
<h2>List and Nav Part</h2>
<h3>List</h3>
<p>Horizontal list: </p>
<ul class="list-inline">
<p>Horizonal Defination List: work is on left, corresponding explanation is on right</p>
</ul>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">dl</span> <span class="na">class</span><span class="o">=</span><span class="s">"dl-horizontal"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">dt</span><span class="p">&gt;</span>Word<span class="p">&lt;/</span><span class="nt">dt</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">dd</span><span class="p">&gt;</span>Explanation<span class="p">&lt;/</span><span class="nt">dd</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">dl</span><span class="p">&gt;</span>
</pre>


<p>List Groups (like a vertical nav bar):</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">'list-group'</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"list-group-item"</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre>


<p>Make list group hyperlink (vertical nav bar)</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"list-group"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">'#'</span> <span class="na">class</span><span class="o">=</span><span class="s">"list-group-item (active)"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>
            <span class="c">&lt;!--You can dd .glyphicon for icons before text. span is easier to use--&gt;</span>
        <span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>


<h3>Nav Bar</h3>
<p>Create nav bar in tabs: <code>&lt;ul class="nav nav-tabs"&gt;&lt;li class="active"&gt;</code>. To add icon to tabs, just put span.</p>
<p>Create nav bar in pills: <code>&lt;ul class="nav nav-pills"&gt;&lt;li&gt;</code>.</p>
<p>Create vertical nav bar: <code>&lt;ul class="nav nav-pills nav-stacked"&gt;</code>.</p>
<p>Dropdown nav bar:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"nav nav-tabs"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">"dropdown"</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown-toggle"</span><span class="p">&gt;</span>FirstClass<span class="p">&lt;</span><span class="nt">b</span> <span class="na">class</span><span class="o">=</span><span class="s">"caret"</span><span class="p">&gt;&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> //First class menu
            <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown-menu"</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>... //Second class items
</pre>


<p>To make a justified nav bar, or make any elements justify-aligned, use <code>nav-justified</code> class. The way to use it is:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">'nav-justified'</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre>


<p>Disable nav bar items:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"disabled"</span><span class="p">&gt;</span>
    content
<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre>


<p>A full example:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">nav</span> <span class="na">role</span><span class="o">=</span><span class="s">"navigation"</span> <span class="na">class</span><span class="o">=</span><span class="s">"navbar navbar-default"</span><span class="p">&gt;</span>
    <span class="c">&lt;!--First class nav bar--&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"navbar-header"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">data-target</span><span class="o">=</span><span class="s">"#navbarCollapse"</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">"collapse"</span> <span class="na">class</span><span class="o">=</span><span class="s">"navbar-toggle"</span><span class="p">&gt;</span>
        <span class="c">&lt;!--Header is the button that when change to mobile, the only item that will not be put to menu button--&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"iron-bar"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"iron-bar"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
            <span class="c">&lt;!--put as many as the number of nav items--&gt;</span>
        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">""</span><span class="p">&gt;</span>NavBarHead<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"navbarCollapse"</span> <span class="na">class</span><span class="o">=</span><span class="s">"collapse navbar-collapse"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">"nav navbar-nav"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown"</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">"dropdown"</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown-toggle"</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>
                FirstClassItem <span class="c">&lt;!-- //Item that is going to have dropdown--&gt;</span>
                <span class="p">&lt;</span><span class="nt">b</span> <span class="na">class</span><span class="o">=</span><span class="s">"caret"</span><span class="p">&gt;&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">role</span><span class="o">=</span><span class="s">"menu"</span> <span class="na">class</span><span class="o">=</span><span class="s">"dropdown-menu"</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">&gt;</span>SecondClassItem<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="c">&lt;!--Can add &lt;li class="divider"&gt;&lt;/li&gt; as divider between items--&gt;</span>
</pre>


<p>Fixed position nav bar: add <code>.navbar-fixed-top/.navbar-fixed-bottom</code> in <code>nav</code> tag.</p>
<p>Full width nav bar: add <code>.navbar-static-top/bottom</code> in <code>nav</code> tag</p>
<p>Nav Bar with Search Form:</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"navbarCollapse"</span> <span class="na">class</span><span class="o">=</span><span class="s">"collapse navbar-collapse"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">role</span><span class="o">=</span><span class="s">"search"</span> <span class="na">class</span><span class="o">=</span><span class="s">"navbar-form navbar-left"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-group"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"text"</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">"search"</span> <span class="na">class</span><span class="o">=</span><span class="s">"form-control"</span><span class="p">&gt;</span>
</pre>


<p>Inversed navbar (color): add <code>.navbar-inverse</code> in <code>nav</code> tag</p>
<h2>Table Part</h2>
<p><code>.table-striped</code> make table's nth row has different color than n-1th row</p>
<p><code>.table-bordered</code> add border</p>
<p><code>.table-hover</code> add hover effect</p>
<p><code>.table-condensed</code> cut the cell padding in half. Most obviously cell height is in half size.</p>
<pre class="code literal-block"><span></span><span class="p">&lt;</span><span class="nt">table</span> <span class="na">class</span><span class="o">=</span><span class="s">"table table-XXX"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</pre>


<p>Responsive Table in Bootstrap3: <code>.table-responsive</code>. Will add scroll bar if table width is larger than container width, when device size is under 768px(i.e.<code>.xs</code>);</p>
<h2>Text Part</h2>
<p><code>.small</code> crates grey and smaller font</p>
<p><code>.lead</code> creates standing-out font</p>
<p>text alignment class: <code>text-left</code>, <code>text-center</code>, <code>text-right</code>, <code>text-justify</code>, <code>text-nowrap</code></p>
<p>text style class: <code>&lt;b&gt;</code>:bold, <code>&lt;big&gt;</code>:bigger, <code>&lt;code&gt;</code>:computer code, <code>&lt;i&gt;</code>:italic, <code>&lt;mark&gt;</code>:highlight, <code>&lt;strong&gt;</code>: strong, <code>&lt;sub&gt;/&lt;sup&gt;</code>:lift and move down font, <code>&lt;ins&gt;</code>: unline, <code>&lt;del&gt;</code>: delete line</p>
<p>text style class:</p>
<p>-<code>.text-lowercase</code></p>
<p>-<code>.text-uppercase</code></p>
<p>-<code>.text-capitalize</code>: only first letter of each work will be upper case</p>
<p>Bootstrap text emphasis class (text with color):</p>
<p>-<code>.text-muted</code>: greyed out</p>
<p>-<code>.text-primary</code>: important, default is blue</p>
<p>-<code>.text-success</code>: default is green</p>
<p>-<code>.text-info</code>: default is blue-grey</p>
<p>-<code>.text-warning</code>: default is brown</p>
<p>-<code>.text-danger</code>: default is red</p>
<p>Quotes:</p>
<p>-<code>&lt;blockquote&gt;</code>: start of a block of quote</p>
<p>-<code>&lt;cite&gt;</code>: cite author name</p>
<p>-<code>.pull-right</code>: all block text align is right</p>
</div>
            </div>
        </div>
            <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2.html" rel="prev">Newer posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="pengyinsnotes";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2016         <a href="mailto:shanpy901115@gmail.com">Pengyin Shan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
