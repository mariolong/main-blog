<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This post includes useful SQL tips I read online or learned in work, including using RDBMS directly or programming for it. This post will be updated continually.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SQL Tips | Pengyin Shan's Note</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">
<link rel="canonical" href="http://pengyin-shan.com/posts/2015/Data%20Science/sql-tips/">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="description" itemprop="description" content="This post includes useful SQL tips I read online or learned in work, including using RDBMS directly or programming for it. This post will be updated continually.">
<meta name="author" content="Pengyin Shan">
<link rel="prev" href="../../Java/junit-basics/" title="JUnit Basics" type="text/html">
<link rel="next" href="../../Linux/ubuntu-tips/" title="Ubuntu Tips" type="text/html">
<meta property="og:site_name" content="Pengyin Shan's Note">
<meta property="og:title" content="SQL Tips">
<meta property="og:url" content="http://pengyin-shan.com/posts/2015/Data%20Science/sql-tips/">
<meta property="og:description" content="This post includes useful SQL tips I read online or learned in work, including using RDBMS directly or programming for it. This post will be updated continually.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-07-30T00:00:00-04:00">
<meta property="article:tag" content="Database">
<meta property="article:tag" content="SQL">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://pengyin-shan.com/">

                <span id="blog-title">Pengyin Shan's Note</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../../archive.html">Archive</a>
                </li>
<li>
<a href="../../../../categories/">Tags</a>
                </li>
<li>
<a href="../../../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="../../Data%20Science/sql-tips/index.md" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="../../Data%20Science/sql-tips/" class="u-url">SQL Tips</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    Pengyin Shan
            </span></p>
            <p class="dateline"><a href="../../Data%20Science/sql-tips/" rel="bookmark"><time class="published dt-published" datetime="2015-07-30T00:00:00-04:00" itemprop="datePublished" title="2015-07-30 00:00">2015-07-30 00:00</time></a></p>
                <p class="commentline">
        
    <a href="../../Data%20Science/sql-tips/#disqus_thread" data-disqus-identifier="cache/posts/2015/Data Science/sql-tips.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="../../Data%20Science/sql-tips/index.md" id="sourcelink">Source</a></p>

                <meta name="description" itemprop="description" content="This post includes useful SQL tips I read online or learned in work, including using RDBMS directly or programming for it. This post will be updated continually.">
</div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<h4>Using SQLProcessor in Java</h4>
<p>My current job requires me to work on some old Java web application, which involves in connecting to Oracle SQL database using <code>SQLProcesoor</code>.</p>
<h5>Basic Syntax</h5>
<pre class="code literal-block"><span></span><span class="c1">//Assume you want to return an ArrayList of 'Course' objects</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SQLProcessorExample</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Course</span><span class="o">&gt;</span> <span class="nf">selectSQLExample</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span> <span class="n">anyParameter</span><span class="o">){</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Course</span><span class="o">&gt;</span> <span class="n">courses</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Course</span><span class="o">&gt;;</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="n">SQLProcessor</span> <span class="n">sProc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SQLProcessor</span><span class="o">();</span>
            <span class="n">PreparedStatementGenerator</span> <span class="n">coursePSG</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PreparedStatementGenerator</span><span class="o">()</span> <span class="o">{</span>
                    <span class="kd">public</span> <span class="n">PreparedStatement</span> <span class="nf">generatePrepareStatement</span><span class="o">(</span><span class="n">Connection</span> <span class="n">conn</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
                        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"select * from test_table where test_para = ?"</span><span class="o">;</span>
                        <span class="n">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
                        <span class="c1">//Note: Index starting from 1. You can also use setInt or other setting methods</span>
                        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">anyParameter</span><span class="o">);</span>
                        <span class="k">return</span> <span class="n">ps</span><span class="o">;</span>
                    <span class="o">}</span>
            <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;();</span>
            <span class="c1">//Use MultiResultListReader if you have mutiple rows returned</span>
            <span class="n">MultiResultListReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MultiResultListReader</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
            <span class="n">sProc</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">coursePSG</span><span class="o">,</span> <span class="n">database_connection</span><span class="o">,</span> <span class="n">reader</span><span class="o">);</span>
            <span class="c1">//Deal with your results</span>
            <span class="k">for</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">row</span> <span class="o">:</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Course</span> <span class="n">result_c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Course</span><span class="o">();</span>
                <span class="n">result_c</span><span class="o">.</span><span class="na">setCourseNumber</span><span class="o">(</span><span class="n">row</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
                <span class="n">result_c</span><span class="o">.</span><span class="na">setSectionNumber</span><span class="o">(</span><span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
                <span class="c1">//Process results...</span>
                <span class="n">courses</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">result_c</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="c1">//Handle exceptions</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>


<h5>Important Tips</h5>
<p>If you have any trouble in your query and have no idea after checking with error message, try run this query in your <strong>DB workbench</strong> first. This may help with possible syntax error.</p>
<p>If you run query sucessfully in your DB workbench, but you get a <code>Invalid Indentifer</code> or <code>Invalid Keyword</code> exception in your Java app. <strong>Make sure you check your query in code with all necessary white spaces. You may have muliple lines of query code and you forget spaces at the end of one line.</strong></p>
<p>Example:</p>
<pre class="code literal-block"><span></span>```java
String sql = "select * from table_test a, table_test2 b" +
            "where id = 1";
//Notice this sql doesn't have white_space between 'b' and 'where', which will cause trouble
</pre>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../categories/database/" rel="tag">Database</a></li>
            <li><a class="tag p-category" href="../../../../categories/sql/" rel="tag">SQL</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../Java/junit-basics/" rel="prev" title="JUnit Basics">Previous post</a>
            </li>
            <li class="next">
                <a href="../../Linux/ubuntu-tips/" rel="next" title="Ubuntu Tips">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="pengyinnote",
            disqus_url="http://pengyin-shan.com/posts/2015/Data%20Science/sql-tips/",
        disqus_title="SQL Tips",
        disqus_identifier="cache/posts/2015/Data Science/sql-tips.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="pengyinnote";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:shanpy901115@gmail.com">Pengyin Shan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
